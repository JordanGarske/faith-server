import{w as Tt}from"./with-props-BhD4tHF7.js";import{r as D,l as u,w as wt,q as st}from"./chunk-XJI4KG32-Cq5X3dzK.js";import{T as Rt}from"./Typography-CluFhDAZ.js";import{c as xt}from"./createSvgIcon-jhuiP-Y0.js";import{c as yt,u as bt,s as ht,m as Bt,a as pt}from"./createSimplePaletteValueFilter-fRiM--k4.js";import{a as It,b as Dt,B as gt}from"./Button-1KVLjP8X.js";import{T as Et}from"./TextField-Dvq4VFKp.js";import{C as $t}from"./Container-DKCCK0q-.js";import{h as Mt,c as Pt,i as ut,r as lt,j as At,k as kt,m as Lt,g as vt,n as Wt,o as ft,a as Ht,e as F,b as Ft,B as dt}from"./Box-Du8asfLc.js";import{s as Ot,u as jt}from"./useThemeProps-BBboNXJ3.js";import"./assertThisInitialized-BjnbojEp.js";import"./isFocusVisible-C-YuzOMb.js";import"./useSlot-vurnxfYK.js";import"./isHostComponent-BEUSeWmW.js";import"./utils-BYBn_PtA.js";import"./index-CVTmJPMc.js";import"./isMuiElement-D8UOlcw4.js";const J={50:"#eceff1",100:"#cfd8dc",200:"#b0bec5",300:"#90a4ae",500:"#607d8b",700:"#455a64"},Gt=Wt(),zt=Ot("div",{name:"MuiStack",slot:"Root"});function _t(a){return jt({props:a,name:"MuiStack",defaultTheme:Gt})}function Nt(a,d){const g=D.Children.toArray(a).filter(Boolean);return g.reduce((P,T,y)=>(P.push(T),y<g.length-1&&P.push(D.cloneElement(d,{key:`separator-${y}`})),P),[])}const Ut=a=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[a],qt=({ownerState:a,theme:d})=>{let g={display:"flex",flexDirection:"column",...ut({theme:d},lt({values:a.direction,breakpoints:d.breakpoints.values}),P=>({flexDirection:P}))};if(a.spacing){const P=At(d),T=Object.keys(d.breakpoints.values).reduce((f,b)=>((typeof a.spacing=="object"&&a.spacing[b]!=null||typeof a.direction=="object"&&a.direction[b]!=null)&&(f[b]=!0),f),{}),y=lt({values:a.direction,base:T}),$=lt({values:a.spacing,base:T});typeof y=="object"&&Object.keys(y).forEach((f,b,E)=>{if(!y[f]){const L=b>0?y[E[b-1]]:"column";y[f]=L}}),g=kt(g,ut({theme:d},$,(f,b)=>a.useFlexGap?{gap:ft(P,f)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${Ut(b?y[b]:a.direction)}`]:ft(P,f)}}))}return g=Lt(d.breakpoints,g),g};function Vt(a={}){const{createStyledComponent:d=zt,useThemeProps:g=_t,componentName:P="MuiStack"}=a,T=()=>yt({root:["root"]},f=>vt(P,f),{}),y=d(qt);return D.forwardRef(function(f,b){const E=g(f),B=Mt(E),{component:L="div",direction:O="column",spacing:j=0,divider:G,children:I,className:h,useFlexGap:c=!1,...r}=B,t={direction:O,spacing:j,useFlexGap:c},e=T();return u.jsx(y,{as:L,ownerState:t,ref:b,className:Pt(e.root,h),...r,children:G?Nt(I,G):I})})}function Yt(a){return D.Children.toArray(a).filter(d=>D.isValidElement(d))}function Zt(a){return vt("MuiButtonGroup",a)}const w=Ht("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),Xt=(a,d)=>{const{ownerState:g}=a;return[{[`& .${w.grouped}`]:d.grouped},{[`& .${w.grouped}`]:d[`grouped${F(g.orientation)}`]},{[`& .${w.grouped}`]:d[`grouped${F(g.variant)}`]},{[`& .${w.grouped}`]:d[`grouped${F(g.variant)}${F(g.orientation)}`]},{[`& .${w.grouped}`]:d[`grouped${F(g.variant)}${F(g.color)}`]},{[`& .${w.firstButton}`]:d.firstButton},{[`& .${w.lastButton}`]:d.lastButton},{[`& .${w.middleButton}`]:d.middleButton},d.root,d[g.variant],g.disableElevation===!0&&d.disableElevation,g.fullWidth&&d.fullWidth,g.orientation==="vertical"&&d.vertical]},Jt=a=>{const{classes:d,color:g,disabled:P,disableElevation:T,fullWidth:y,orientation:$,variant:x}=a,f={root:["root",x,$,y&&"fullWidth",T&&"disableElevation",`color${F(g)}`],grouped:["grouped",`grouped${F($)}`,`grouped${F(x)}`,`grouped${F(x)}${F($)}`,`grouped${F(x)}${F(g)}`,P&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return yt(f,Zt,d)},Kt=ht("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:Xt})(Bt(({theme:a})=>({display:"inline-flex",borderRadius:(a.vars||a).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(a.vars||a).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${w.lastButton},& .${w.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${w.firstButton},& .${w.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${w.firstButton},& .${w.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${w.lastButton},& .${w.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${w.firstButton},& .${w.middleButton}`]:{borderRight:a.vars?`1px solid rgba(${a.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${a.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${w.disabled}`]:{borderRight:`1px solid ${(a.vars||a).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${w.firstButton},& .${w.middleButton}`]:{borderBottom:a.vars?`1px solid rgba(${a.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${a.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${w.disabled}`]:{borderBottom:`1px solid ${(a.vars||a).palette.action.disabled}`}}}},...Object.entries(a.palette).filter(pt()).flatMap(([d])=>[{props:{variant:"text",color:d},style:{[`& .${w.firstButton},& .${w.middleButton}`]:{borderColor:a.vars?`rgba(${a.vars.palette[d].mainChannel} / 0.5)`:Ft(a.palette[d].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${w.firstButton},& .${w.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${w.lastButton},& .${w.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${w.firstButton},& .${w.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${w.lastButton},& .${w.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${w.firstButton},& .${w.middleButton}`]:{borderRight:`1px solid ${(a.vars||a).palette.grey[400]}`,[`&.${w.disabled}`]:{borderRight:`1px solid ${(a.vars||a).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${w.firstButton},& .${w.middleButton}`]:{borderBottom:`1px solid ${(a.vars||a).palette.grey[400]}`,[`&.${w.disabled}`]:{borderBottom:`1px solid ${(a.vars||a).palette.action.disabled}`}}}},...Object.entries(a.palette).filter(pt(["dark"])).map(([d])=>({props:{variant:"contained",color:d},style:{[`& .${w.firstButton},& .${w.middleButton}`]:{borderColor:(a.vars||a).palette[d].dark}}}))],[`& .${w.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),Qt=D.forwardRef(function(d,g){const P=bt({props:d,name:"MuiButtonGroup"}),{children:T,className:y,color:$="primary",component:x="div",disabled:f=!1,disableElevation:b=!1,disableFocusRipple:E=!1,disableRipple:B=!1,fullWidth:L=!1,orientation:O="horizontal",size:j="medium",variant:G="outlined",...I}=P,h={...P,color:$,component:x,disabled:f,disableElevation:b,disableFocusRipple:E,disableRipple:B,fullWidth:L,orientation:O,size:j,variant:G},c=Jt(h),r=D.useMemo(()=>({className:c.grouped,color:$,disabled:f,disableElevation:b,disableFocusRipple:E,disableRipple:B,fullWidth:L,size:j,variant:G}),[$,f,b,E,B,L,j,G,c.grouped]),t=Yt(T),e=t.length,i=s=>{const n=s===0,o=s===e-1;return n&&o?"":n?c.firstButton:o?c.lastButton:c.middleButton};return u.jsx(Kt,{as:x,role:"group",className:Pt(c.root,y),ref:g,ownerState:h,...I,children:u.jsx(It.Provider,{value:r,children:t.map((s,n)=>u.jsx(Dt.Provider,{value:i(n),children:s},n))})})}),te=Vt({createStyledComponent:ht("div",{name:"MuiStack",slot:"Root"}),useThemeProps:a=>bt({props:a,name:"MuiStack"})}),ee=xt(u.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),ie=xt(u.jsx("path",{d:"M19 13H5v-2h14z"}));var ct={exports:{}};(function(a,d){(function(g,P){P(d)})(wt,function(g){class P{constructor(t,e){this.state={angle:0,area:[],position:{x:0,y:0},hardAngle:0,hardDrawingAngle:0},this.createdDensity=e,this.nowDrawingDensity=this.createdDensity,this.render=t}setDensity(t){this.createdDensity=t,this.nowDrawingDensity=t}setDrawingDensity(t){this.nowDrawingDensity=t}setPosition(t){this.state.position=t}setAngle(t){this.state.angle=t}setArea(t){this.state.area=t}setHardDrawingAngle(t){this.state.hardDrawingAngle=t}setHardAngle(t){this.state.hardAngle=t,this.state.hardDrawingAngle=t}setOrientation(t){this.orientation=t}getDrawingDensity(){return this.nowDrawingDensity}getDensity(){return this.createdDensity}getHardAngle(){return this.state.hardAngle}}class T extends P{constructor(t,e,i){super(t,i),this.image=null,this.isLoad=!1,this.loadingAngle=0,this.image=new Image,this.image.src=e}draw(t){const e=this.render.getContext(),i=this.render.convertToGlobal(this.state.position),s=this.render.getRect().pageWidth,n=this.render.getRect().height;e.save(),e.translate(i.x,i.y),e.beginPath();for(let o of this.state.area)o!==null&&(o=this.render.convertToGlobal(o),e.lineTo(o.x-i.x,o.y-i.y));e.rotate(this.state.angle),e.clip(),this.isLoad?e.drawImage(this.image,0,0,s,n):this.drawLoader(e,{x:0,y:0},s,n),e.restore()}simpleDraw(t){const e=this.render.getRect(),i=this.render.getContext(),s=e.pageWidth,n=e.height,o=t===1?e.left+e.pageWidth:e.left,l=e.top;this.isLoad?i.drawImage(this.image,o,l,s,n):this.drawLoader(i,{x:o,y:l},s,n)}drawLoader(t,e,i,s){t.beginPath(),t.strokeStyle="rgb(200, 200, 200)",t.fillStyle="rgb(255, 255, 255)",t.lineWidth=1,t.rect(e.x+1,e.y+1,i-1,s-1),t.stroke(),t.fill();const n={x:e.x+i/2,y:e.y+s/2};t.beginPath(),t.lineWidth=10,t.arc(n.x,n.y,20,this.loadingAngle,3*Math.PI/2+this.loadingAngle),t.stroke(),t.closePath(),this.loadingAngle+=.07,this.loadingAngle>=2*Math.PI&&(this.loadingAngle=0)}load(){this.isLoad||(this.image.onload=()=>{this.isLoad=!0})}newTemporaryCopy(){return this}getTemporaryCopy(){return this}hideTemporaryCopy(){}}class y{constructor(t,e){this.pages=[],this.currentPageIndex=0,this.currentSpreadIndex=0,this.landscapeSpread=[],this.portraitSpread=[],this.render=e,this.app=t,this.currentPageIndex=0,this.isShowCover=this.app.getSettings().showCover}destroy(){this.pages=[]}createSpread(){this.landscapeSpread=[],this.portraitSpread=[];for(let e=0;e<this.pages.length;e++)this.portraitSpread.push([e]);let t=0;this.isShowCover&&(this.pages[0].setDensity("hard"),this.landscapeSpread.push([t]),t++);for(let e=t;e<this.pages.length;e+=2)e<this.pages.length-1?this.landscapeSpread.push([e,e+1]):(this.landscapeSpread.push([e]),this.pages[e].setDensity("hard"))}getSpread(){return this.render.getOrientation()==="landscape"?this.landscapeSpread:this.portraitSpread}getSpreadIndexByPage(t){const e=this.getSpread();for(let i=0;i<e.length;i++)if(t===e[i][0]||t===e[i][1])return i;return null}getPageCount(){return this.pages.length}getPages(){return this.pages}getPage(t){if(t>=0&&t<this.pages.length)return this.pages[t];throw new Error("Invalid page number")}nextBy(t){const e=this.pages.indexOf(t);return e<this.pages.length-1?this.pages[e+1]:null}prevBy(t){const e=this.pages.indexOf(t);return e>0?this.pages[e-1]:null}getFlippingPage(t){const e=this.currentSpreadIndex;if(this.render.getOrientation()==="portrait")return t===0?this.pages[e].newTemporaryCopy():this.pages[e-1];{const i=t===0?this.getSpread()[e+1]:this.getSpread()[e-1];return i.length===1||t===0?this.pages[i[0]]:this.pages[i[1]]}}getBottomPage(t){const e=this.currentSpreadIndex;if(this.render.getOrientation()==="portrait")return t===0?this.pages[e+1]:this.pages[e-1];{const i=t===0?this.getSpread()[e+1]:this.getSpread()[e-1];return i.length===1?this.pages[i[0]]:t===0?this.pages[i[1]]:this.pages[i[0]]}}showNext(){this.currentSpreadIndex<this.getSpread().length&&(this.currentSpreadIndex++,this.showSpread())}showPrev(){this.currentSpreadIndex>0&&(this.currentSpreadIndex--,this.showSpread())}getCurrentPageIndex(){return this.currentPageIndex}show(t=null){if(t===null&&(t=this.currentPageIndex),t<0||t>=this.pages.length)return;const e=this.getSpreadIndexByPage(t);e!==null&&(this.currentSpreadIndex=e,this.showSpread())}getCurrentSpreadIndex(){return this.currentSpreadIndex}setCurrentSpreadIndex(t){if(!(t>=0&&t<this.getSpread().length))throw new Error("Invalid page");this.currentSpreadIndex=t}showSpread(){const t=this.getSpread()[this.currentSpreadIndex];t.length===2?(this.render.setLeftPage(this.pages[t[0]]),this.render.setRightPage(this.pages[t[1]])):this.render.getOrientation()==="landscape"&&t[0]===this.pages.length-1?(this.render.setLeftPage(this.pages[t[0]]),this.render.setRightPage(null)):(this.render.setLeftPage(null),this.render.setRightPage(this.pages[t[0]])),this.currentPageIndex=t[0],this.app.updatePageIndex(this.currentPageIndex)}}class $ extends y{constructor(t,e,i){super(t,e),this.imagesHref=i}load(){for(const t of this.imagesHref){const e=new T(this.render,t,"soft");e.load(),this.pages.push(e)}this.createSpread()}}class x{static GetDistanceBetweenTwoPoint(t,e){return t===null||e===null?1/0:Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static GetSegmentLength(t){return x.GetDistanceBetweenTwoPoint(t[0],t[1])}static GetAngleBetweenTwoLine(t,e){const i=t[0].y-t[1].y,s=e[0].y-e[1].y,n=t[1].x-t[0].x,o=e[1].x-e[0].x;return Math.acos((i*s+n*o)/(Math.sqrt(i*i+n*n)*Math.sqrt(s*s+o*o)))}static PointInRect(t,e){return e===null?null:e.x>=t.left&&e.x<=t.width+t.left&&e.y>=t.top&&e.y<=t.top+t.height?e:null}static GetRotatedPoint(t,e,i){return{x:t.x*Math.cos(i)+t.y*Math.sin(i)+e.x,y:t.y*Math.cos(i)-t.x*Math.sin(i)+e.y}}static LimitPointToCircle(t,e,i){if(x.GetDistanceBetweenTwoPoint(t,i)<=e)return i;const s=t.x,n=t.y,o=i.x,l=i.y;let p=Math.sqrt(Math.pow(e,2)*Math.pow(s-o,2)/(Math.pow(s-o,2)+Math.pow(n-l,2)))+s;i.x<0&&(p*=-1);let v=(p-s)*(n-l)/(s-o)+n;return s-o+n===0&&(v=e),{x:p,y:v}}static GetIntersectBetweenTwoSegment(t,e,i){return x.PointInRect(t,x.GetIntersectBeetwenTwoLine(e,i))}static GetIntersectBeetwenTwoLine(t,e){const i=t[0].y-t[1].y,s=e[0].y-e[1].y,n=t[1].x-t[0].x,o=e[1].x-e[0].x,l=t[0].x*t[1].y-t[1].x*t[0].y,p=e[0].x*e[1].y-e[1].x*e[0].y,v=i*p-s*l,R=n*p-o*l,A=-(l*o-p*n)/(i*o-s*n),U=-(i*p-s*l)/(i*o-s*n);if(isFinite(A)&&isFinite(U))return{x:A,y:U};if(Math.abs(v-R)<.1)throw new Error("Segment included");return null}static GetCordsFromTwoPoint(t,e){const i=Math.abs(t.x-e.x),s=Math.abs(t.y-e.y),n=Math.max(i,s),o=[t];function l(p,v,R,A,U){return v>p?p+U*(R/A):v<p?p-U*(R/A):p}for(let p=1;p<=n;p+=1)o.push({x:l(t.x,e.x,i,n,p),y:l(t.y,e.y,s,n,p)});return o}}class f extends P{constructor(t,e,i){super(t,i),this.copiedElement=null,this.temporaryCopy=null,this.isLoad=!1,this.element=e,this.element.classList.add("stf__item"),this.element.classList.add("--"+i)}newTemporaryCopy(){return this.nowDrawingDensity==="hard"?this:(this.temporaryCopy===null&&(this.copiedElement=this.element.cloneNode(!0),this.element.parentElement.appendChild(this.copiedElement),this.temporaryCopy=new f(this.render,this.copiedElement,this.nowDrawingDensity)),this.getTemporaryCopy())}getTemporaryCopy(){return this.temporaryCopy}hideTemporaryCopy(){this.temporaryCopy!==null&&(this.copiedElement.remove(),this.copiedElement=null,this.temporaryCopy=null)}draw(t){const e=t||this.nowDrawingDensity,i=this.render.convertToGlobal(this.state.position),s=this.render.getRect().pageWidth,n=this.render.getRect().height;this.element.classList.remove("--simple");const o=`
            display: block;
            z-index: ${this.element.style.zIndex};
            left: 0;
            top: 0;
            width: ${s}px;
            height: ${n}px;
        `;e==="hard"?this.drawHard(o):this.drawSoft(i,o)}drawHard(t=""){const e=this.render.getRect().left+this.render.getRect().width/2,i=this.state.hardDrawingAngle,s=t+`
                backface-visibility: hidden;
                -webkit-backface-visibility: hidden;
                clip-path: none;
                -webkit-clip-path: none;
            `+(this.orientation===0?`transform-origin: ${this.render.getRect().pageWidth}px 0; 
                   transform: translate3d(0, 0, 0) rotateY(${i}deg);`:`transform-origin: 0 0; 
                   transform: translate3d(${e}px, 0, 0) rotateY(${i}deg);`);this.element.style.cssText=s}drawSoft(t,e=""){let i="polygon( ";for(const n of this.state.area)if(n!==null){let o=this.render.getDirection()===1?{x:-n.x+this.state.position.x,y:n.y-this.state.position.y}:{x:n.x-this.state.position.x,y:n.y-this.state.position.y};o=x.GetRotatedPoint(o,{x:0,y:0},this.state.angle),i+=o.x+"px "+o.y+"px, "}i=i.slice(0,-2),i+=")";const s=e+`transform-origin: 0 0; clip-path: ${i}; -webkit-clip-path: ${i};`+(this.render.isSafari()&&this.state.angle===0?`transform: translate(${t.x}px, ${t.y}px);`:`transform: translate3d(${t.x}px, ${t.y}px, 0) rotate(${this.state.angle}rad);`);this.element.style.cssText=s}simpleDraw(t){const e=this.render.getRect(),i=e.pageWidth,s=e.height,n=t===1?e.left+e.pageWidth:e.left,o=e.top;this.element.classList.add("--simple"),this.element.style.cssText=`
            position: absolute; 
            display: block; 
            height: ${s}px; 
            left: ${n}px; 
            top: ${o}px; 
            width: ${i}px; 
            z-index: ${this.render.getSettings().startZIndex+1};`}getElement(){return this.element}load(){this.isLoad=!0}setOrientation(t){super.setOrientation(t),this.element.classList.remove("--left","--right"),this.element.classList.add(t===1?"--right":"--left")}setDrawingDensity(t){this.element.classList.remove("--soft","--hard"),this.element.classList.add("--"+t),super.setDrawingDensity(t)}}class b extends y{constructor(t,e,i,s){super(t,e),this.element=i,this.pagesElement=s}load(){for(const t of this.pagesElement){const e=new f(this.render,t,t.dataset.density==="hard"?"hard":"soft");e.load(),this.pages.push(e)}this.createSpread()}}class E{constructor(t,e,i,s){this.direction=t,this.corner=e,this.topIntersectPoint=null,this.sideIntersectPoint=null,this.bottomIntersectPoint=null,this.pageWidth=parseInt(i,10),this.pageHeight=parseInt(s,10)}calc(t){try{return this.position=this.calcAngleAndPosition(t),this.calculateIntersectPoint(this.position),!0}catch{return!1}}getFlippingClipArea(){const t=[];let e=!1;return t.push(this.rect.topLeft),t.push(this.topIntersectPoint),this.sideIntersectPoint===null?e=!0:(t.push(this.sideIntersectPoint),this.bottomIntersectPoint===null&&(e=!1)),t.push(this.bottomIntersectPoint),(e||this.corner==="bottom")&&t.push(this.rect.bottomLeft),t}getBottomClipArea(){const t=[];return t.push(this.topIntersectPoint),this.corner==="top"?t.push({x:this.pageWidth,y:0}):(this.topIntersectPoint!==null&&t.push({x:this.pageWidth,y:0}),t.push({x:this.pageWidth,y:this.pageHeight})),this.sideIntersectPoint!==null?x.GetDistanceBetweenTwoPoint(this.sideIntersectPoint,this.topIntersectPoint)>=10&&t.push(this.sideIntersectPoint):this.corner==="top"&&t.push({x:this.pageWidth,y:this.pageHeight}),t.push(this.bottomIntersectPoint),t.push(this.topIntersectPoint),t}getAngle(){return this.direction===0?-this.angle:this.angle}getRect(){return this.rect}getPosition(){return this.position}getActiveCorner(){return this.direction===0?this.rect.topLeft:this.rect.topRight}getDirection(){return this.direction}getFlippingProgress(){return Math.abs((this.position.x-this.pageWidth)/(2*this.pageWidth)*100)}getCorner(){return this.corner}getBottomPagePosition(){return this.direction===1?{x:this.pageWidth,y:0}:{x:0,y:0}}getShadowStartPoint(){return this.corner==="top"?this.topIntersectPoint:this.sideIntersectPoint!==null?this.sideIntersectPoint:this.topIntersectPoint}getShadowAngle(){const t=x.GetAngleBetweenTwoLine(this.getSegmentToShadowLine(),[{x:0,y:0},{x:this.pageWidth,y:0}]);return this.direction===0?t:Math.PI-t}calcAngleAndPosition(t){let e=t;if(this.updateAngleAndGeometry(e),e=this.corner==="top"?this.checkPositionAtCenterLine(e,{x:0,y:0},{x:0,y:this.pageHeight}):this.checkPositionAtCenterLine(e,{x:0,y:this.pageHeight},{x:0,y:0}),Math.abs(e.x-this.pageWidth)<1&&Math.abs(e.y)<1)throw new Error("Point is too small");return e}updateAngleAndGeometry(t){this.angle=this.calculateAngle(t),this.rect=this.getPageRect(t)}calculateAngle(t){const e=this.pageWidth-t.x+1,i=this.corner==="bottom"?this.pageHeight-t.y:t.y;let s=2*Math.acos(e/Math.sqrt(i*i+e*e));i<0&&(s=-s);const n=Math.PI-s;if(!isFinite(s)||n>=0&&n<.003)throw new Error("The G point is too small");return this.corner==="bottom"&&(s=-s),s}getPageRect(t){return this.corner==="top"?this.getRectFromBasePoint([{x:0,y:0},{x:this.pageWidth,y:0},{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}],t):this.getRectFromBasePoint([{x:0,y:-this.pageHeight},{x:this.pageWidth,y:-this.pageHeight},{x:0,y:0},{x:this.pageWidth,y:0}],t)}getRectFromBasePoint(t,e){return{topLeft:this.getRotatedPoint(t[0],e),topRight:this.getRotatedPoint(t[1],e),bottomLeft:this.getRotatedPoint(t[2],e),bottomRight:this.getRotatedPoint(t[3],e)}}getRotatedPoint(t,e){return{x:t.x*Math.cos(this.angle)+t.y*Math.sin(this.angle)+e.x,y:t.y*Math.cos(this.angle)-t.x*Math.sin(this.angle)+e.y}}calculateIntersectPoint(t){const e={left:-1,top:-1,width:this.pageWidth+2,height:this.pageHeight+2};this.corner==="top"?(this.topIntersectPoint=x.GetIntersectBetweenTwoSegment(e,[t,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=x.GetIntersectBetweenTwoSegment(e,[t,this.rect.bottomLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=x.GetIntersectBetweenTwoSegment(e,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}])):(this.topIntersectPoint=x.GetIntersectBetweenTwoSegment(e,[this.rect.topLeft,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=x.GetIntersectBetweenTwoSegment(e,[t,this.rect.topLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=x.GetIntersectBetweenTwoSegment(e,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}]))}checkPositionAtCenterLine(t,e,i){let s=t;const n=x.LimitPointToCircle(e,this.pageWidth,s);s!==n&&(s=n,this.updateAngleAndGeometry(s));const o=Math.sqrt(Math.pow(this.pageWidth,2)+Math.pow(this.pageHeight,2));let l=this.rect.bottomRight,p=this.rect.topLeft;if(this.corner==="bottom"&&(l=this.rect.topRight,p=this.rect.bottomLeft),l.x<=0){const v=x.LimitPointToCircle(i,o,p);v!==s&&(s=v,this.updateAngleAndGeometry(s))}return s}getSegmentToShadowLine(){const t=this.getShadowStartPoint();return[t,t!==this.sideIntersectPoint&&this.sideIntersectPoint!==null?this.sideIntersectPoint:this.bottomIntersectPoint]}}class B{constructor(t,e){this.flippingPage=null,this.bottomPage=null,this.calc=null,this.state="read",this.render=t,this.app=e}fold(t){this.setState("user_fold"),this.calc===null&&this.start(t),this.do(this.render.convertToPage(t))}flip(t){if(this.app.getSettings().disableFlipByClick&&!this.isPointOnCorners(t)||(this.calc!==null&&this.render.finishAnimation(),!this.start(t)))return;const e=this.getBoundsRect();this.setState("flipping");const i=e.height/10,s=this.calc.getCorner()==="bottom"?e.height-i:i,n=this.calc.getCorner()==="bottom"?e.height:0;this.calc.calc({x:e.pageWidth-i,y:s}),this.animateFlippingTo({x:e.pageWidth-i,y:s},{x:-e.pageWidth,y:n},!0)}start(t){this.reset();const e=this.render.convertToBook(t),i=this.getBoundsRect(),s=this.getDirectionByPoint(e),n=e.y>=i.height/2?"bottom":"top";if(!this.checkDirection(s))return!1;try{if(this.flippingPage=this.app.getPageCollection().getFlippingPage(s),this.bottomPage=this.app.getPageCollection().getBottomPage(s),this.render.getOrientation()==="landscape")if(s===1){const o=this.app.getPageCollection().nextBy(this.flippingPage);o!==null&&this.flippingPage.getDensity()!==o.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),o.setDrawingDensity("hard"))}else{const o=this.app.getPageCollection().prevBy(this.flippingPage);o!==null&&this.flippingPage.getDensity()!==o.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),o.setDrawingDensity("hard"))}return this.render.setDirection(s),this.calc=new E(s,n,i.pageWidth.toString(10),i.height.toString(10)),!0}catch{return!1}}do(t){if(this.calc!==null&&this.calc.calc(t)){const e=this.calc.getFlippingProgress();this.bottomPage.setArea(this.calc.getBottomClipArea()),this.bottomPage.setPosition(this.calc.getBottomPagePosition()),this.bottomPage.setAngle(0),this.bottomPage.setHardAngle(0),this.flippingPage.setArea(this.calc.getFlippingClipArea()),this.flippingPage.setPosition(this.calc.getActiveCorner()),this.flippingPage.setAngle(this.calc.getAngle()),this.calc.getDirection()===0?this.flippingPage.setHardAngle(90*(200-2*e)/100):this.flippingPage.setHardAngle(-90*(200-2*e)/100),this.render.setPageRect(this.calc.getRect()),this.render.setBottomPage(this.bottomPage),this.render.setFlippingPage(this.flippingPage),this.render.setShadowData(this.calc.getShadowStartPoint(),this.calc.getShadowAngle(),e,this.calc.getDirection())}}flipToPage(t,e){const i=this.app.getPageCollection().getCurrentSpreadIndex(),s=this.app.getPageCollection().getSpreadIndexByPage(t);try{s>i&&(this.app.getPageCollection().setCurrentSpreadIndex(s-1),this.flipNext(e)),s<i&&(this.app.getPageCollection().setCurrentSpreadIndex(s+1),this.flipPrev(e))}catch{}}flipNext(t){this.flip({x:this.render.getRect().left+2*this.render.getRect().pageWidth-10,y:t==="top"?1:this.render.getRect().height-2})}flipPrev(t){this.flip({x:10,y:t==="top"?1:this.render.getRect().height-2})}stopMove(){if(this.calc===null)return;const t=this.calc.getPosition(),e=this.getBoundsRect(),i=this.calc.getCorner()==="bottom"?e.height:0;t.x<=0?this.animateFlippingTo(t,{x:-e.pageWidth,y:i},!0):this.animateFlippingTo(t,{x:e.pageWidth,y:i},!1)}showCorner(t){if(!this.checkState("read","fold_corner"))return;const e=this.getBoundsRect(),i=e.pageWidth;if(this.isPointOnCorners(t))if(this.calc===null){if(!this.start(t))return;this.setState("fold_corner"),this.calc.calc({x:i-1,y:1});const s=50,n=this.calc.getCorner()==="bottom"?e.height-1:1,o=this.calc.getCorner()==="bottom"?e.height-s:s;this.animateFlippingTo({x:i-1,y:n},{x:i-s,y:o},!1,!1)}else this.do(this.render.convertToPage(t));else this.setState("read"),this.render.finishAnimation(),this.stopMove()}animateFlippingTo(t,e,i,s=!0){const n=x.GetCordsFromTwoPoint(t,e),o=[];for(const p of n)o.push(()=>this.do(p));const l=this.getAnimationDuration(n.length);this.render.startAnimation(o,l,()=>{this.calc&&(i&&(this.calc.getDirection()===1?this.app.turnToPrevPage():this.app.turnToNextPage()),s&&(this.render.setBottomPage(null),this.render.setFlippingPage(null),this.render.clearShadow(),this.setState("read"),this.reset()))})}getCalculation(){return this.calc}getState(){return this.state}setState(t){this.state!==t&&(this.app.updateState(t),this.state=t)}getDirectionByPoint(t){const e=this.getBoundsRect();if(this.render.getOrientation()==="portrait"){if(t.x-e.pageWidth<=e.width/5)return 1}else if(t.x<e.width/2)return 1;return 0}getAnimationDuration(t){const e=this.app.getSettings().flippingTime;return t>=1e3?e:t/1e3*e}checkDirection(t){return t===0?this.app.getCurrentPageIndex()<this.app.getPageCount()-1:this.app.getCurrentPageIndex()>=1}reset(){this.calc=null,this.flippingPage=null,this.bottomPage=null}getBoundsRect(){return this.render.getRect()}checkState(...t){for(const e of t)if(this.state===e)return!0;return!1}isPointOnCorners(t){const e=this.getBoundsRect(),i=e.pageWidth,s=Math.sqrt(Math.pow(i,2)+Math.pow(e.height,2))/5,n=this.render.convertToBook(t);return n.x>0&&n.y>0&&n.x<e.width&&n.y<e.height&&(n.x<s||n.x>e.width-s)&&(n.y<s||n.y>e.height-s)}}class L{constructor(t,e){this.leftPage=null,this.rightPage=null,this.flippingPage=null,this.bottomPage=null,this.direction=null,this.orientation=null,this.shadow=null,this.animation=null,this.pageRect=null,this.boundsRect=null,this.timer=0,this.safari=!1,this.setting=e,this.app=t;const i=new RegExp("Version\\/[\\d\\.]+.*Safari/");this.safari=i.exec(window.navigator.userAgent)!==null}render(t){if(this.animation!==null){const e=Math.round((t-this.animation.startedAt)/this.animation.durationFrame);e<this.animation.frames.length?this.animation.frames[e]():(this.animation.onAnimateEnd(),this.animation=null)}this.timer=t,this.drawFrame()}start(){this.update();const t=e=>{this.render(e),requestAnimationFrame(t)};requestAnimationFrame(t)}startAnimation(t,e,i){this.finishAnimation(),this.animation={frames:t,duration:e,durationFrame:e/t.length,onAnimateEnd:i,startedAt:this.timer}}finishAnimation(){this.animation!==null&&(this.animation.frames[this.animation.frames.length-1](),this.animation.onAnimateEnd!==null&&this.animation.onAnimateEnd()),this.animation=null}update(){this.boundsRect=null;const t=this.calculateBoundsRect();this.orientation!==t&&(this.orientation=t,this.app.updateOrientation(t))}calculateBoundsRect(){let t="landscape";const e=this.getBlockWidth(),i=e/2,s=this.getBlockHeight()/2,n=this.setting.width/this.setting.height;let o=this.setting.width,l=this.setting.height,p=i-o;return this.setting.size==="stretch"?(e<2*this.setting.minWidth&&this.app.getSettings().usePortrait&&(t="portrait"),o=t==="portrait"?this.getBlockWidth():this.getBlockWidth()/2,o>this.setting.maxWidth&&(o=this.setting.maxWidth),l=o/n,l>this.getBlockHeight()&&(l=this.getBlockHeight(),o=l*n),p=t==="portrait"?i-o/2-o:i-o):e<2*o&&this.app.getSettings().usePortrait&&(t="portrait",p=i-o/2-o),this.boundsRect={left:p,top:s-l/2,width:2*o,height:l,pageWidth:o},t}setShadowData(t,e,i,s){if(!this.app.getSettings().drawShadow)return;const n=100*this.getSettings().maxShadowOpacity;this.shadow={pos:t,angle:e,width:3*this.getRect().pageWidth/4*i/100,opacity:(100-i)*n/100/100,direction:s,progress:2*i}}clearShadow(){this.shadow=null}getBlockWidth(){return this.app.getUI().getDistElement().offsetWidth}getBlockHeight(){return this.app.getUI().getDistElement().offsetHeight}getDirection(){return this.direction}getRect(){return this.boundsRect===null&&this.calculateBoundsRect(),this.boundsRect}getSettings(){return this.app.getSettings()}getOrientation(){return this.orientation}setPageRect(t){this.pageRect=t}setDirection(t){this.direction=t}setRightPage(t){t!==null&&t.setOrientation(1),this.rightPage=t}setLeftPage(t){t!==null&&t.setOrientation(0),this.leftPage=t}setBottomPage(t){t!==null&&t.setOrientation(this.direction===1?0:1),this.bottomPage=t}setFlippingPage(t){t!==null&&t.setOrientation(this.direction===0&&this.orientation!=="portrait"?0:1),this.flippingPage=t}convertToBook(t){const e=this.getRect();return{x:t.x-e.left,y:t.y-e.top}}isSafari(){return this.safari}convertToPage(t,e){e||(e=this.direction);const i=this.getRect();return{x:e===0?t.x-i.left-i.width/2:i.width/2-t.x+i.left,y:t.y-i.top}}convertToGlobal(t,e){if(e||(e=this.direction),t==null)return null;const i=this.getRect();return{x:e===0?t.x+i.left+i.width/2:i.width/2-t.x+i.left,y:t.y+i.top}}convertRectToGlobal(t,e){return e||(e=this.direction),{topLeft:this.convertToGlobal(t.topLeft,e),topRight:this.convertToGlobal(t.topRight,e),bottomLeft:this.convertToGlobal(t.bottomLeft,e),bottomRight:this.convertToGlobal(t.bottomRight,e)}}}class O extends L{constructor(t,e,i){super(t,e),this.canvas=i,this.ctx=i.getContext("2d")}getContext(){return this.ctx}reload(){}drawFrame(){this.clear(),this.orientation!=="portrait"&&this.leftPage!=null&&this.leftPage.simpleDraw(0),this.rightPage!=null&&this.rightPage.simpleDraw(1),this.bottomPage!=null&&this.bottomPage.draw(),this.drawBookShadow(),this.flippingPage!=null&&this.flippingPage.draw(),this.shadow!=null&&(this.drawOuterShadow(),this.drawInnerShadow());const t=this.getRect();this.orientation==="portrait"&&(this.ctx.beginPath(),this.ctx.rect(t.left+t.pageWidth,t.top,t.width,t.height),this.ctx.clip())}drawBookShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath();const e=t.width/20;this.ctx.rect(t.left,t.top,t.width,t.height);const i={x:t.left+t.width/2-e/2,y:0};this.ctx.translate(i.x,i.y);const s=this.ctx.createLinearGradient(0,0,e,0);s.addColorStop(0,"rgba(0, 0, 0, 0)"),s.addColorStop(.4,"rgba(0, 0, 0, 0.2)"),s.addColorStop(.49,"rgba(0, 0, 0, 0.1)"),s.addColorStop(.5,"rgba(0, 0, 0, 0.5)"),s.addColorStop(.51,"rgba(0, 0, 0, 0.4)"),s.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.clip(),this.ctx.fillStyle=s,this.ctx.fillRect(0,0,e,2*t.height),this.ctx.restore()}drawOuterShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(t.left,t.top,t.width,t.height);const e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y});this.ctx.translate(e.x,e.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const i=this.ctx.createLinearGradient(0,0,this.shadow.width,0);this.shadow.direction===0?(this.ctx.translate(0,-100),i.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),i.addColorStop(1,"rgba(0, 0, 0, 0)")):(this.ctx.translate(-this.shadow.width,-100),i.addColorStop(0,"rgba(0, 0, 0, 0)"),i.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")")),this.ctx.clip(),this.ctx.fillStyle=i,this.ctx.fillRect(0,0,this.shadow.width,2*t.height),this.ctx.restore()}drawInnerShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath();const e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),i=this.convertRectToGlobal(this.pageRect);this.ctx.moveTo(i.topLeft.x,i.topLeft.y),this.ctx.lineTo(i.topRight.x,i.topRight.y),this.ctx.lineTo(i.bottomRight.x,i.bottomRight.y),this.ctx.lineTo(i.bottomLeft.x,i.bottomLeft.y),this.ctx.translate(e.x,e.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const s=3*this.shadow.width/4,n=this.ctx.createLinearGradient(0,0,s,0);this.shadow.direction===0?(this.ctx.translate(-s,-100),n.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")"),n.addColorStop(.9,"rgba(0, 0, 0, 0.05)"),n.addColorStop(.7,"rgba(0, 0, 0, "+this.shadow.opacity+")"),n.addColorStop(0,"rgba(0, 0, 0, 0)")):(this.ctx.translate(0,-100),n.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),n.addColorStop(.1,"rgba(0, 0, 0, 0.05)"),n.addColorStop(.3,"rgba(0, 0, 0, "+this.shadow.opacity+")"),n.addColorStop(1,"rgba(0, 0, 0, 0)")),this.ctx.clip(),this.ctx.fillStyle=n,this.ctx.fillRect(0,0,s,2*t.height),this.ctx.restore()}clear(){this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}}class j{constructor(t,e,i){this.touchPoint=null,this.swipeTimeout=250,this.onResize=()=>{this.update()},this.onMouseDown=n=>{if(this.checkTarget(n.target)){const o=this.getMousePos(n.clientX,n.clientY);this.app.startUserTouch(o),n.preventDefault()}},this.onTouchStart=n=>{if(this.checkTarget(n.target)&&n.changedTouches.length>0){const o=n.changedTouches[0],l=this.getMousePos(o.clientX,o.clientY);this.touchPoint={point:l,time:Date.now()},setTimeout(()=>{this.touchPoint!==null&&this.app.startUserTouch(l)},this.swipeTimeout),this.app.getSettings().mobileScrollSupport||n.preventDefault()}},this.onMouseUp=n=>{const o=this.getMousePos(n.clientX,n.clientY);this.app.userStop(o)},this.onMouseMove=n=>{const o=this.getMousePos(n.clientX,n.clientY);this.app.userMove(o,!1)},this.onTouchMove=n=>{if(n.changedTouches.length>0){const o=n.changedTouches[0],l=this.getMousePos(o.clientX,o.clientY);this.app.getSettings().mobileScrollSupport?(this.touchPoint!==null&&(Math.abs(this.touchPoint.point.x-l.x)>10||this.app.getState()!=="read")&&n.cancelable&&this.app.userMove(l,!0),this.app.getState()!=="read"&&n.preventDefault()):this.app.userMove(l,!0)}},this.onTouchEnd=n=>{if(n.changedTouches.length>0){const o=n.changedTouches[0],l=this.getMousePos(o.clientX,o.clientY);let p=!1;if(this.touchPoint!==null){const v=l.x-this.touchPoint.point.x,R=Math.abs(l.y-this.touchPoint.point.y);Math.abs(v)>this.swipeDistance&&R<2*this.swipeDistance&&Date.now()-this.touchPoint.time<this.swipeTimeout&&(v>0?this.app.flipPrev(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"):this.app.flipNext(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"),p=!0),this.touchPoint=null}this.app.userStop(l,p)}},this.parentElement=t,t.classList.add("stf__parent"),t.insertAdjacentHTML("afterbegin",'<div class="stf__wrapper"></div>'),this.wrapper=t.querySelector(".stf__wrapper"),this.app=e;const s=this.app.getSettings().usePortrait?1:2;t.style.minWidth=i.minWidth*s+"px",t.style.minHeight=i.minHeight+"px",i.size==="fixed"&&(t.style.minWidth=i.width*s+"px",t.style.minHeight=i.height+"px"),i.autoSize&&(t.style.width="100%",t.style.maxWidth=2*i.maxWidth+"px"),t.style.display="block",window.addEventListener("resize",this.onResize,!1),this.swipeDistance=i.swipeDistance}destroy(){this.app.getSettings().useMouseEvents&&this.removeHandlers(),this.distElement.remove(),this.wrapper.remove()}getDistElement(){return this.distElement}getWrapper(){return this.wrapper}setOrientationStyle(t){this.wrapper.classList.remove("--portrait","--landscape"),t==="portrait"?(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/this.app.getSettings().width*100+"%"),this.wrapper.classList.add("--portrait")):(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/(2*this.app.getSettings().width)*100+"%"),this.wrapper.classList.add("--landscape")),this.update()}removeHandlers(){window.removeEventListener("resize",this.onResize),this.distElement.removeEventListener("mousedown",this.onMouseDown),this.distElement.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchend",this.onTouchEnd)}setHandlers(){window.addEventListener("resize",this.onResize,!1),this.app.getSettings().useMouseEvents&&(this.distElement.addEventListener("mousedown",this.onMouseDown),this.distElement.addEventListener("touchstart",this.onTouchStart),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!this.app.getSettings().mobileScrollSupport}),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchend",this.onTouchEnd))}getMousePos(t,e){const i=this.distElement.getBoundingClientRect();return{x:t-i.left,y:e-i.top}}checkTarget(t){return!this.app.getSettings().clickEventForward||!["a","button"].includes(t.tagName.toLowerCase())}}class G extends j{constructor(t,e,i,s){super(t,e,i),this.wrapper.insertAdjacentHTML("afterbegin",'<div class="stf__block"></div>'),this.distElement=t.querySelector(".stf__block"),this.items=s;for(const n of s)this.distElement.appendChild(n);this.setHandlers()}clear(){for(const t of this.items)this.parentElement.appendChild(t)}updateItems(t){this.removeHandlers(),this.distElement.innerHTML="";for(const e of t)this.distElement.appendChild(e);this.items=t,this.setHandlers()}update(){this.app.getRender().update()}}class I extends j{constructor(t,e,i){super(t,e,i),this.wrapper.innerHTML='<canvas class="stf__canvas"></canvas>',this.canvas=t.querySelectorAll("canvas")[0],this.distElement=this.canvas,this.resizeCanvas(),this.setHandlers()}resizeCanvas(){const t=getComputedStyle(this.canvas),e=parseInt(t.getPropertyValue("width"),10),i=parseInt(t.getPropertyValue("height"),10);this.canvas.width=e,this.canvas.height=i}getCanvas(){return this.canvas}update(){this.resizeCanvas(),this.app.getRender().update()}}class h extends L{constructor(t,e,i){super(t,e),this.outerShadow=null,this.innerShadow=null,this.hardShadow=null,this.hardInnerShadow=null,this.element=i,this.createShadows()}createShadows(){this.element.insertAdjacentHTML("beforeend",`<div class="stf__outerShadow"></div>
             <div class="stf__innerShadow"></div>
             <div class="stf__hardShadow"></div>
             <div class="stf__hardInnerShadow"></div>`),this.outerShadow=this.element.querySelector(".stf__outerShadow"),this.innerShadow=this.element.querySelector(".stf__innerShadow"),this.hardShadow=this.element.querySelector(".stf__hardShadow"),this.hardInnerShadow=this.element.querySelector(".stf__hardInnerShadow")}clearShadow(){super.clearShadow(),this.outerShadow.style.cssText="display: none",this.innerShadow.style.cssText="display: none",this.hardShadow.style.cssText="display: none",this.hardInnerShadow.style.cssText="display: none"}reload(){this.element.querySelector(".stf__outerShadow")||this.createShadows()}drawHardInnerShadow(){const t=this.getRect(),e=this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress;let i=(100-e)*(2.5*t.pageWidth)/100+20;i>t.pageWidth&&(i=t.pageWidth);let s=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+5).toString(10)};
            width: ${i}px;
            height: ${t.height}px;
            background: linear-gradient(to right,
                rgba(0, 0, 0, ${this.shadow.opacity*e/100}) 5%,
                rgba(0, 0, 0, 0) 100%);
            left: ${t.left+t.width/2}px;
            transform-origin: 0 0;
        `;s+=this.getDirection()===0&&this.shadow.progress>100||this.getDirection()===1&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0);":"transform: translate3d(0, 0, 0) rotateY(180deg);",this.hardInnerShadow.style.cssText=s}drawHardOuterShadow(){const t=this.getRect();let e=(100-(this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress))*(2.5*t.pageWidth)/100+20;e>t.pageWidth&&(e=t.pageWidth);let i=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+4).toString(10)};
            width: ${e}px;
            height: ${t.height}px;
            background: linear-gradient(to left, rgba(0, 0, 0, ${this.shadow.opacity}) 5%, rgba(0, 0, 0, 0) 100%);
            left: ${t.left+t.width/2}px;
            transform-origin: 0 0;
        `;i+=this.getDirection()===0&&this.shadow.progress>100||this.getDirection()===1&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0) rotateY(180deg);":"transform: translate3d(0, 0, 0);",this.hardShadow.style.cssText=i}drawInnerShadow(){const t=this.getRect(),e=3*this.shadow.width/4,i=this.getDirection()===0?e:0,s=this.getDirection()===0?"to left":"to right",n=this.convertToGlobal(this.shadow.pos),o=this.shadow.angle+3*Math.PI/2,l=[this.pageRect.topLeft,this.pageRect.topRight,this.pageRect.bottomRight,this.pageRect.bottomLeft];let p="polygon( ";for(const R of l){let A=this.getDirection()===1?{x:-R.x+this.shadow.pos.x,y:R.y-this.shadow.pos.y}:{x:R.x-this.shadow.pos.x,y:R.y-this.shadow.pos.y};A=x.GetRotatedPoint(A,{x:i,y:100},o),p+=A.x+"px "+A.y+"px, "}p=p.slice(0,-2),p+=")";const v=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+10).toString(10)};
            width: ${e}px;
            height: ${2*t.height}px;
            background: linear-gradient(${s},
                rgba(0, 0, 0, ${this.shadow.opacity}) 5%,
                rgba(0, 0, 0, 0.05) 15%,
                rgba(0, 0, 0, ${this.shadow.opacity}) 35%,
                rgba(0, 0, 0, 0) 100%);
            transform-origin: ${i}px 100px;
            transform: translate3d(${n.x-i}px, ${n.y-100}px, 0) rotate(${o}rad);
            clip-path: ${p};
            -webkit-clip-path: ${p};
        `;this.innerShadow.style.cssText=v}drawOuterShadow(){const t=this.getRect(),e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),i=this.shadow.angle+3*Math.PI/2,s=this.getDirection()===1?this.shadow.width:0,n=this.getDirection()===0?"to right":"to left",o=[{x:0,y:0},{x:t.pageWidth,y:0},{x:t.pageWidth,y:t.height},{x:0,y:t.height}];let l="polygon( ";for(const v of o)if(v!==null){let R=this.getDirection()===1?{x:-v.x+this.shadow.pos.x,y:v.y-this.shadow.pos.y}:{x:v.x-this.shadow.pos.x,y:v.y-this.shadow.pos.y};R=x.GetRotatedPoint(R,{x:s,y:100},i),l+=R.x+"px "+R.y+"px, "}l=l.slice(0,-2),l+=")";const p=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+10).toString(10)};
            width: ${this.shadow.width}px;
            height: ${2*t.height}px;
            background: linear-gradient(${n}, rgba(0, 0, 0, ${this.shadow.opacity}), rgba(0, 0, 0, 0));
            transform-origin: ${s}px 100px;
            transform: translate3d(${e.x-s}px, ${e.y-100}px, 0) rotate(${i}rad);
            clip-path: ${l};
            -webkit-clip-path: ${l};
        `;this.outerShadow.style.cssText=p}drawLeftPage(){this.orientation!=="portrait"&&this.leftPage!==null&&(this.direction===1&&this.flippingPage!==null&&this.flippingPage.getDrawingDensity()==="hard"?(this.leftPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.leftPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.leftPage.draw(this.flippingPage.getDrawingDensity())):this.leftPage.simpleDraw(0))}drawRightPage(){this.rightPage!==null&&(this.direction===0&&this.flippingPage!==null&&this.flippingPage.getDrawingDensity()==="hard"?(this.rightPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.rightPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.rightPage.draw(this.flippingPage.getDrawingDensity())):this.rightPage.simpleDraw(1))}drawBottomPage(){if(this.bottomPage===null)return;const t=this.flippingPage!=null?this.flippingPage.getDrawingDensity():null;this.orientation==="portrait"&&this.direction===1||(this.bottomPage.getElement().style.zIndex=(this.getSettings().startZIndex+3).toString(10),this.bottomPage.draw(t))}drawFrame(){this.clear(),this.drawLeftPage(),this.drawRightPage(),this.drawBottomPage(),this.flippingPage!=null&&(this.flippingPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.flippingPage.draw()),this.shadow!=null&&this.flippingPage!==null&&(this.flippingPage.getDrawingDensity()==="soft"?(this.drawOuterShadow(),this.drawInnerShadow()):(this.drawHardOuterShadow(),this.drawHardInnerShadow()))}clear(){for(const t of this.app.getPageCollection().getPages())t!==this.leftPage&&t!==this.rightPage&&t!==this.flippingPage&&t!==this.bottomPage&&(t.getElement().style.cssText="display: none"),t.getTemporaryCopy()!==this.flippingPage&&t.hideTemporaryCopy()}update(){super.update(),this.rightPage!==null&&this.rightPage.setOrientation(1),this.leftPage!==null&&this.leftPage.setOrientation(0)}}class c{constructor(){this._default={startPage:0,size:"fixed",width:0,height:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,drawShadow:!0,flippingTime:1e3,usePortrait:!0,startZIndex:0,autoSize:!0,maxShadowOpacity:1,showCover:!1,mobileScrollSupport:!0,swipeDistance:30,clickEventForward:!0,useMouseEvents:!0,showPageCorners:!0,disableFlipByClick:!1}}getSettings(t){const e=this._default;if(Object.assign(e,t),e.size!=="stretch"&&e.size!=="fixed")throw new Error('Invalid size type. Available only "fixed" and "stretch" value');if(e.width<=0||e.height<=0)throw new Error("Invalid width or height");if(e.flippingTime<=0)throw new Error("Invalid flipping time");return e.size==="stretch"?(e.minWidth<=0&&(e.minWidth=100),e.maxWidth<e.minWidth&&(e.maxWidth=2e3),e.minHeight<=0&&(e.minHeight=100),e.maxHeight<e.minHeight&&(e.maxHeight=2e3)):(e.minWidth=e.width,e.maxWidth=e.width,e.minHeight=e.height,e.maxHeight=e.height),e}}(function(r,t){t===void 0&&(t={});var e=t.insertAt;if(typeof document<"u"){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",e==="top"&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r))}})(`.stf__parent {
  position: relative;
  display: block;
  box-sizing: border-box;
  transform: translateZ(0);

  -ms-touch-action: pan-y;
  touch-action: pan-y;
}

.sft__wrapper {
  position: relative;
  width: 100%;
  box-sizing: border-box;
}

.stf__parent canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
}

.stf__block {
  position: absolute;
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  perspective: 2000px;
}

.stf__item {
  display: none;
  position: absolute;
  transform-style: preserve-3d;
}

.stf__outerShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__innerShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__hardShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__hardInnerShadow {
  position: absolute;
  left: 0;
  top: 0;
}`),g.PageFlip=class extends class{constructor(){this.events=new Map}on(r,t){return this.events.has(r)?this.events.get(r).push(t):this.events.set(r,[t]),this}off(r){this.events.delete(r)}trigger(r,t,e=null){if(this.events.has(r))for(const i of this.events.get(r))i({data:e,object:t})}}{constructor(r,t){super(),this.isUserTouch=!1,this.isUserMove=!1,this.setting=null,this.pages=null,this.setting=new c().getSettings(t),this.block=r}destroy(){this.ui.destroy(),this.block.remove()}update(){this.render.update(),this.pages.show()}loadFromImages(r){this.ui=new I(this.block,this,this.setting);const t=this.ui.getCanvas();this.render=new O(this,this.setting,t),this.flipController=new B(this.render,this),this.pages=new $(this,this.render,r),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout(()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})},1)}loadFromHTML(r){this.ui=new G(this.block,this,this.setting,r),this.render=new h(this,this.setting,this.ui.getDistElement()),this.flipController=new B(this.render,this),this.pages=new b(this,this.render,this.ui.getDistElement(),r),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout(()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})},1)}updateFromImages(r){const t=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new $(this,this.render,r),this.pages.load(),this.pages.show(t),this.trigger("update",this,{page:t,mode:this.render.getOrientation()})}updateFromHtml(r){const t=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new b(this,this.render,this.ui.getDistElement(),r),this.pages.load(),this.ui.updateItems(r),this.render.reload(),this.pages.show(t),this.trigger("update",this,{page:t,mode:this.render.getOrientation()})}clear(){this.pages.destroy(),this.ui.clear()}turnToPrevPage(){this.pages.showPrev()}turnToNextPage(){this.pages.showNext()}turnToPage(r){this.pages.show(r)}flipNext(r="top"){this.flipController.flipNext(r)}flipPrev(r="top"){this.flipController.flipPrev(r)}flip(r,t="top"){this.flipController.flipToPage(r,t)}updateState(r){this.trigger("changeState",this,r)}updatePageIndex(r){this.trigger("flip",this,r)}updateOrientation(r){this.ui.setOrientationStyle(r),this.update(),this.trigger("changeOrientation",this,r)}getPageCount(){return this.pages.getPageCount()}getCurrentPageIndex(){return this.pages.getCurrentPageIndex()}getPage(r){return this.pages.getPage(r)}getRender(){return this.render}getFlipController(){return this.flipController}getOrientation(){return this.render.getOrientation()}getBoundsRect(){return this.render.getRect()}getSettings(){return this.setting}getUI(){return this.ui}getState(){return this.flipController.getState()}getPageCollection(){return this.pages}startUserTouch(r){this.mousePosition=r,this.isUserTouch=!0,this.isUserMove=!1}userMove(r,t){this.isUserTouch||t||!this.setting.showPageCorners?this.isUserTouch&&x.GetDistanceBetweenTwoPoint(this.mousePosition,r)>5&&(this.isUserMove=!0,this.flipController.fold(r)):this.flipController.showCorner(r)}userStop(r,t=!1){this.isUserTouch&&(this.isUserTouch=!1,t||(this.isUserMove?this.flipController.stopMove():this.flipController.flip(r)))}},Object.defineProperty(g,"__esModule",{value:!0})})})(ct,ct.exports);var se=ct.exports;const ne=st.forwardRef((a,d)=>{const g=D.useRef(null),P=D.useRef([]),T=D.useRef(),[y,$]=D.useState([]);D.useImperativeHandle(d,()=>({pageFlip:()=>T.current}));const x=D.useCallback(()=>{T.current&&T.current.clear()},[]),f=D.useCallback(()=>{const b=T.current;b&&(b.off("flip"),b.off("changeOrientation"),b.off("changeState"),b.off("init"),b.off("update"))},[]);return D.useEffect(()=>{if(P.current=[],a.children){const b=st.Children.map(a.children,E=>st.cloneElement(E,{ref:B=>{B&&P.current.push(B)}}));(!a.renderOnlyPageLengthChange||y.length!==b.length)&&(b.length<y.length&&x(),$(b))}},[a.children]),D.useEffect(()=>{const b=()=>{const E=T.current;E&&(a.onFlip&&E.on("flip",B=>a.onFlip(B)),a.onChangeOrientation&&E.on("changeOrientation",B=>a.onChangeOrientation(B)),a.onChangeState&&E.on("changeState",B=>a.onChangeState(B)),a.onInit&&E.on("init",B=>a.onInit(B)),a.onUpdate&&E.on("update",B=>a.onUpdate(B)))};y.length>0&&P.current.length>0&&(f(),g.current&&!T.current&&(T.current=new se.PageFlip(g.current,a)),T.current.getFlipController()?T.current.updateFromHtml(P.current):T.current.loadFromHTML(P.current),b())},[y]),st.createElement("div",{ref:g,className:a.className,style:a.style},y)}),oe=st.memo(ne),re=["January","February","March","April","May","June","July","August","September","October","November","December"];function ae({src:a,setBook:d,month:g}){return a.length===0?null:u.jsx("div",{children:u.jsxs("div",{className:"book-container",onClick:()=>d(a),children:[u.jsx(Rt,{align:"center",variant:"body1",sx:{position:"relative",zIndex:2},children:re[g]}),u.jsx("div",{className:"book",children:u.jsx("img",{src:a[0]})})]})})}const mt=ht(gt)(({theme:a})=>({color:a.palette.getContrastText(J[50]),backgroundColor:J[50],borderColor:J[200],"&:hover":{backgroundColor:J[100],borderColor:J[300]}})),he=ht(Et)({"& .MuiOutlinedInput-root":{"& fieldset":{borderRadius:0,borderColor:J[200]},"&:hover fieldset":{borderColor:J[300]},"&.Mui-focused fieldset":{borderColor:J[500]},"& input":{textAlign:"center",width:60,color:J[700]}}});function le({prev:a,next:d,count:g}){return u.jsx($t,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:u.jsxs(Qt,{children:[u.jsx(mt,{onClick:()=>a(),disabled:g===1,children:u.jsx(ie,{fontSize:"small"})}),u.jsx(he,{size:"small",value:g}),u.jsx(mt,{onClick:()=>d(),children:u.jsx(ee,{fontSize:"small"})})]})})}var St={exports:{}};(function(a,d){(function(g,P){a.exports=P(D)})(typeof self<"u"?self:wt,function(g){return function(){var P={155:function(h){h.exports=g}},T={};function y(h){var c=T[h];if(c!==void 0)return c.exports;var r=T[h]={exports:{}};return P[h](r,r.exports,y),r.exports}y.d=function(h,c){for(var r in c)y.o(c,r)&&!y.o(h,r)&&Object.defineProperty(h,r,{enumerable:!0,get:c[r]})},y.o=function(h,c){return Object.prototype.hasOwnProperty.call(h,c)},y.r=function(h){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})};var $={};y.r($),y.d($,{useReactToPrint:function(){return I}});var x=y(155);function f({level:h="error",messages:c,suppressErrors:r=!1}){r||(h==="error"?console.error(c):h==="warning"?console.warn(c):console.debug(c))}function b(h,c){if(c||!h){const r=document.getElementById("printWindow");r&&document.body.removeChild(r)}}function E(h){return h instanceof Error?h:new Error("Unknown Error")}function B(h,c){const{documentTitle:r,onAfterPrint:t,onPrintError:e,preserveAfterPrint:i,print:s,suppressErrors:n}=c;setTimeout(()=>{var o,l;if(h.contentWindow){let p=function(){t==null||t(),b(i)};if(h.contentWindow.focus(),s)s(h).then(p).catch(v=>{e?e("print",E(v)):f({messages:["An error was thrown by the specified `print` function"],suppressErrors:n})});else{if(h.contentWindow.print){const v=(l=(o=h.contentDocument)===null||o===void 0?void 0:o.title)!==null&&l!==void 0?l:"",R=h.ownerDocument.title;r&&(h.ownerDocument.title=r,h.contentDocument&&(h.contentDocument.title=r)),h.contentWindow.print(),r&&(h.ownerDocument.title=R,h.contentDocument&&(h.contentDocument.title=v))}else f({messages:["Printing for this browser is not currently possible: the browser does not have a `print` method available for iframes."],suppressErrors:n});[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(v=>{var R,A;return((A=(R=navigator.userAgent)!==null&&R!==void 0?R:navigator.vendor)!==null&&A!==void 0?A:"opera"in window&&window.opera).match(v)})?setTimeout(p,500):p()}}else f({messages:["Printing failed because the `contentWindow` of the print iframe did not load. This is possibly an error with `react-to-print`. Please file an issue: https://github.com/MatthewHerbst/react-to-print/issues/"],suppressErrors:n})},500)}function L(h){const c=[],r=document.createTreeWalker(h,NodeFilter.SHOW_ELEMENT,null);let t=r.nextNode();for(;t;)c.push(t),t=r.nextNode();return c}function O(h,c,r){const t=L(h),e=L(c);if(t.length===e.length)for(let i=0;i<t.length;i++){const s=t[i],n=e[i],o=s.shadowRoot;if(o!==null){const l=n.attachShadow({mode:o.mode});l.innerHTML=o.innerHTML,O(o,l,r)}}else f({messages:["When cloning shadow root content, source and target elements have different size. `onBeforePrint` likely resolved too early.",h,c],suppressErrors:r})}const j=`
    @page {
        /* Remove browser default header (title) and footer (url) */
        margin: 0;
    }
    @media print {
        body {
            /* Tell browsers to print background colors */
            color-adjust: exact; /* Firefox. This is an older version of "print-color-adjust" */
            print-color-adjust: exact; /* Firefox/Safari */
            -webkit-print-color-adjust: exact; /* Chrome/Safari/Edge/Opera */
        }
    }
`;function G(h,c,r,t){var e,i,s,n,o;const{contentNode:l,clonedContentNode:p,clonedImgNodes:v,clonedVideoNodes:R,numResourcesToLoad:A,originalCanvasNodes:U}=r,{bodyClass:nt,fonts:q,ignoreGlobalStyles:ot,pageStyle:it,nonce:V,suppressErrors:M,copyShadowRoots:tt}=t;h.onload=null;const k=(e=h.contentDocument)!==null&&e!==void 0?e:(i=h.contentWindow)===null||i===void 0?void 0:i.document;if(k){const Y=k.body.appendChild(p);tt&&O(l,Y,!!M),q&&(!((s=h.contentDocument)===null||s===void 0)&&s.fonts&&(!((n=h.contentWindow)===null||n===void 0)&&n.FontFace)?q.forEach(S=>{const m=new FontFace(S.family,S.source,{weight:S.weight,style:S.style});h.contentDocument.fonts.add(m),m.loaded.then(()=>{c(m)}).catch(H=>{c(m,["Failed loading the font:",m,"Load error:",E(H)])})}):(q.forEach(S=>{c(S)}),f({messages:['"react-to-print" is not able to load custom fonts because the browser does not support the FontFace API but will continue attempting to print the page'],suppressErrors:M})));const et=it??j,K=k.createElement("style");V&&(K.setAttribute("nonce",V),k.head.setAttribute("nonce",V)),K.appendChild(k.createTextNode(et)),k.head.appendChild(K),nt&&k.body.classList.add(...nt.split(" "));const N=k.querySelectorAll("canvas");for(let S=0;S<U.length;++S){const m=U[S],H=N[S];if(H===void 0){f({messages:["A canvas element could not be copied for printing, has it loaded? `onBeforePrint` likely resolved too early.",m],suppressErrors:M});continue}const C=H.getContext("2d");C&&C.drawImage(m,0,0)}for(let S=0;S<v.length;S++){const m=v[S],H=m.getAttribute("src");if(H){const C=new Image;C.onload=()=>{c(m)},C.onerror=(W,z,Q,_,X)=>{c(m,["Error loading <img>",m,"Error",X])},C.src=H}else c(m,['Found an <img> tag with an empty "src" attribute. This prevents pre-loading it.',m])}for(let S=0;S<R.length;S++){const m=R[S];m.preload="auto";const H=m.getAttribute("poster");if(H){const C=new Image;C.onload=()=>{c(m)},C.onerror=(W,z,Q,_,X)=>{c(m,["Error loading video poster",H,"for video",m,"Error:",X])},C.src=H}else m.readyState>=2?c(m):m.src?(m.onloadeddata=()=>{c(m)},m.onerror=(C,W,z,Q,_)=>{c(m,["Error loading video",m,"Error",_])},m.onstalled=()=>{c(m,["Loading video stalled, skipping",m])}):c(m,["Error loading video, `src` is empty",m])}const Z="select",rt=l.querySelectorAll(Z),at=k.querySelectorAll(Z);for(let S=0;S<rt.length;S++)at[S].value=rt[S].value;if(!ot){const S=document.querySelectorAll("style, link[rel~='stylesheet'], link[as='style']");for(let m=0,H=S.length;m<H;++m){const C=S[m];if(C.tagName.toLowerCase()==="style"){const W=k.createElement(C.tagName),z=C.sheet;if(z){let Q="";try{const _=z.cssRules.length;for(let X=0;X<_;++X)typeof z.cssRules[X].cssText=="string"&&(Q+=`${z.cssRules[X].cssText}\r
`)}catch(_){f({messages:["A stylesheet could not be accessed. This is likely due to the stylesheet having cross-origin imports, and many browsers block script access to cross-origin stylesheets. See https://github.com/MatthewHerbst/react-to-print/issues/429 for details. You may be able to load the sheet by both marking the stylesheet with the cross `crossorigin` attribute, and setting the `Access-Control-Allow-Origin` header on the server serving the stylesheet. Alternatively, host the stylesheet on your domain to avoid this issue entirely.",C,`Original error: ${E(_).message}`],level:"warning"})}W.setAttribute("id",`react-to-print-${m}`),V&&W.setAttribute("nonce",V),W.appendChild(k.createTextNode(Q)),k.head.appendChild(W)}}else if(C.getAttribute("href"))if(C.hasAttribute("disabled"))f({messages:["`react-to-print` encountered a <link> tag with a `disabled` attribute and will ignore it. Note that the `disabled` attribute is deprecated, and some browsers ignore it. You should stop using it. https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-disabled. The <link> is:",C],level:"warning"}),c(C);else{const W=k.createElement(C.tagName);for(let z=0,Q=C.attributes.length;z<Q;++z){const _=C.attributes[z];_&&W.setAttribute(_.nodeName,(o=_.nodeValue)!==null&&o!==void 0?o:"")}W.onload=()=>{c(W)},W.onerror=(z,Q,_,X,Ct)=>{c(W,["Failed to load",W,"Error:",Ct])},V&&W.setAttribute("nonce",V),k.head.appendChild(W)}else f({messages:["`react-to-print` encountered a <link> tag with an empty `href` attribute. In addition to being invalid HTML, this can cause problems in many browsers, and so the <link> was not loaded. The <link> is:",C],level:"warning"}),c(C)}}}A===0&&B(h,t)}function I({bodyClass:h,contentRef:c,copyShadowRoots:r,documentTitle:t,fonts:e,ignoreGlobalStyles:i,nonce:s,onAfterPrint:n,onBeforePrint:o,onPrintError:l,pageStyle:p,preserveAfterPrint:v,print:R,suppressErrors:A}){return(0,x.useCallback)(U=>{function nt(){const q={bodyClass:h,contentRef:c,copyShadowRoots:r,documentTitle:t,fonts:e,ignoreGlobalStyles:i,nonce:s,onAfterPrint:n,onPrintError:l,pageStyle:p,preserveAfterPrint:v,print:R,suppressErrors:A},ot=function(){const M=document.createElement("iframe");return M.width=`${document.documentElement.clientWidth}px`,M.height=`${document.documentElement.clientHeight}px`,M.style.position="absolute",M.style.top=`-${document.documentElement.clientHeight+100}px`,M.style.left=`-${document.documentElement.clientWidth+100}px`,M.id="printWindow",M.srcdoc="<!DOCTYPE html>",M}(),it=function(M,tt){const{contentRef:k,fonts:Y,ignoreGlobalStyles:et,suppressErrors:K}=tt,N=function({contentRef:H,optionalContent:C,suppressErrors:W}){return C&&typeof C=="function"?(H&&f({level:"warning",messages:['"react-to-print" received a `contentRef` option and an optional-content param passed to its callback. The `contentRef` option will be ignored.']}),C()):H?H.current:void f({messages:['"react-to-print" did not receive a `contentRef` option or a optional-content param pass to its callback.'],suppressErrors:W})}({contentRef:k,optionalContent:M,suppressErrors:K});if(!N)return;const Z=N.cloneNode(!0),rt=document.querySelectorAll("link[rel~='stylesheet'], link[as='style']"),at=Z.querySelectorAll("img"),S=Z.querySelectorAll("video"),m=Y?Y.length:0;return{contentNode:N,clonedContentNode:Z,clonedImgNodes:at,clonedVideoNodes:S,numResourcesToLoad:(et?0:rt.length)+at.length+S.length+m,originalCanvasNodes:N.querySelectorAll("canvas")}}(U,q);if(!it)return void f({messages:["There is nothing to print"],suppressErrors:A});const V=function(M,tt,k){const{suppressErrors:Y}=M,et=[],K=[];return function(N,Z){et.includes(N)?f({level:"debug",messages:["Tried to mark a resource that has already been handled",N],suppressErrors:Y}):(Z?(f({messages:['"react-to-print" was unable to load a resource but will continue attempting to print the page',...Z],suppressErrors:Y}),K.push(N)):et.push(N),et.length+K.length===tt&&B(k,M))}}(q,it.numResourcesToLoad,ot);(function(M,tt,k,Y){M.onload=()=>{G(M,tt,k,Y)},document.body.appendChild(M)})(ot,V,it,q)}b(v,!0),o?o().then(()=>{nt()}).catch(q=>{l==null||l("onBeforePrint",E(q))}):nt()},[h,c,r,t,e,i,s,n,o,l,p,v,R,A])}return $}()})})(St);var de=St.exports;const ce=st.forwardRef(({imageUrls:a},d)=>u.jsx("div",{ref:d,className:"print-container",children:a.map((g,P)=>u.jsx("div",{className:"print-page",children:u.jsx("img",{src:g,alt:`Image ${P}`,className:"print-image"})},P))}));function ge({imageUrls:a}){const d=D.useRef(null),g=de.useReactToPrint({contentRef:d,ignoreGlobalStyles:!0,pageStyle:`
      @media print {
        @page {
          size: letter portrait;
          margin: 0;
        }
        html, body {
          margin: 0;
          padding: 0;
        }
        .print-page {
          page-break-after: always;
          width: 8.5in;   /* Letter width */
          height: 11in;   /* Letter height */
          display: flex;
          justify-content: center;
          align-items: center;
          overflow: hidden;
        }
        .print-image {
          width: 8.5in;   /* match page width */
          height: 11in;   /* match page height */

          image-resolution: 200dpi; /* ensure 200 DPI printing */
        }
      }
    `,documentTitle:"Full Width Images"});return u.jsxs("div",{children:[u.jsx("div",{style:{display:"none"},children:u.jsx(ce,{ref:d,imageUrls:a})}),u.jsx(gt,{variant:"contained",onClick:g,children:"Print / Download"})]})}function pe({url:a,imageUrls:d}){const g=()=>{window.open(a,"_blank","noopener,noreferrer")};return u.jsx("div",{style:{textAlign:"center"},children:u.jsxs(te,{direction:"row",spacing:2,justifyContent:"center",children:[u.jsx(gt,{variant:"contained",color:"primary",onClick:g,children:"Open PDF"}),u.jsx(ge,{imageUrls:d})]})})}const $e=Tt(function(){const[d,g]=D.useState([]),[P,T]=D.useState([]),[y,$]=D.useState(""),[x,f]=D.useState([]),[b,E]=D.useState(!0),[B,L]=D.useState(1),O=D.useRef(null);D.useEffect(()=>{(async()=>{try{const c=await(await fetch("/api/get/newsletter")).json(),t=await(await fetch("/api/get/pdf-newsletter")).json(),e=new Date().getMonth();g(c[e]),T(c),console.log(t),f(t),$(t[e]),E(!1)}catch(h){console.error("Error fetching newsletter data:",h)}})()},[]);const j=()=>{var I;L(h=>Math.max(h-1,1)),(I=O.current)==null||I.pageFlip().flipPrev()},G=()=>{var I;L(h=>Math.min(h+1,d.length)),(I=O.current)==null||I.pageFlip().flipNext()};return b?u.jsx("div",{children:"Loading..."}):u.jsxs(u.Fragment,{children:[u.jsx(dt,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mt:"40px"},children:P.map((I,h)=>u.jsx(ae,{src:I,month:h,setBook:()=>{L(1),g(I),$(x[h-1])}},h))}),u.jsxs(dt,{sx:{mt:"50px"},children:[u.jsxs(u.Fragment,{children:[u.jsx(le,{prev:j,next:G,count:`${B}/${d.length}`}),u.jsx(pe,{url:y,imageUrls:d})]}),u.jsx(dt,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flexWrap:"wrap",gap:2,mt:"40px"},children:u.jsxs(oe,{ref:O,width:550,height:800,showCover:!0,onFlip:I=>{console.log(I.data),L(I.data+1)},onInit:I=>console.log("FlipBook initialized with pages:",I.getPageCount()),children:[d.map((I,h)=>u.jsx("img",{src:I,srcSet:I,style:{width:"100%",height:"auto",borderRadius:8}},h)),u.jsx("div",{})]},d.length)})]})]})});function Me({}){return[{title:"news-letter"},{name:"description",content:"news-letter"}]}export{$e as default,Me as meta};
