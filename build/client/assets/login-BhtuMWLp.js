import{w as yo}from"./with-props-D6IowUu_.js";import{r as p,l as t,t as Co,n as wo,q as So}from"./chunk-XJI4KG32-Dmn1iqhE.js";import{a as Y,A as Do}from"./directory-ytBm4kY-.js";import{c as G}from"./isHostComponent-fALf-5Rm.js";import{C as Po}from"./Container-DapPncFN.js";import{c as jo,P as N}from"./Paper-CAJltBP2.js";import{g as A,a as T,c as b,d as g,B as _}from"./Box-CbkMP9ps.js";import{T as M}from"./Typography-rGd-kMH5.js";import{u as ko,B as U}from"./Button-B5zhw822.js";import{u as R,s as v,c as W,m as z}from"./createSimplePaletteValueFilter-B_PxzCPc.js";import{u as k}from"./useSlot-CQUBaJCu.js";import{F as H,M as Mo,B as Ao,u as To,a as Ro,T as V}from"./TextField-Cyj5MloR.js";import{I as Wo}from"./IconButton-y6l6cKIp.js";import"./useThemeProps-BtJPSwZk.js";import"./assertThisInitialized-BjnbojEp.js";import"./index-CSNTZfnI.js";import"./isMuiElement-HV4Zcmjm.js";function $o(e){return T("MuiDialog",e)}const E=A("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),J=p.createContext({}),Io=v(Ao,{name:"MuiDialog",slot:"Backdrop",overrides:(e,o)=>o.backdrop})({zIndex:-1}),Fo=e=>{const{classes:o,scroll:s,maxWidth:r,fullWidth:l,fullScreen:a}=e,i={root:["root"],container:["container",`scroll${g(s)}`],paper:["paper",`paperScroll${g(s)}`,`paperWidth${g(String(r))}`,l&&"paperFullWidth",a&&"paperFullScreen"]};return W(i,$o,o)},Lo=v(Mo,{name:"MuiDialog",slot:"Root",overridesResolver:(e,o)=>o.root})({"@media print":{position:"absolute !important"}}),Bo=v("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.container,o[`scroll${g(s.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Uo=v(N,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.paper,o[`scrollPaper${g(s.scroll)}`],o[`paperWidth${g(String(s.maxWidth))}`],s.fullWidth&&o.paperFullWidth,s.fullScreen&&o.paperFullScreen]}})(z(({theme:e})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:o})=>!o.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:e.breakpoints.unit==="px"?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${E.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(e.breakpoints.values).filter(o=>o!=="xs").map(o=>({props:{maxWidth:o},style:{maxWidth:`${e.breakpoints.values[o]}${e.breakpoints.unit}`,[`&.${E.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[o]+32*2)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:o})=>o.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:o})=>o.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${E.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),Eo=p.forwardRef(function(o,s){const r=R({props:o,name:"MuiDialog"}),l=jo(),a={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{"aria-describedby":i,"aria-labelledby":c,"aria-modal":d=!0,BackdropComponent:h,BackdropProps:x,children:S,className:m,disableEscapeKeyDown:f=!1,fullScreen:y=!1,fullWidth:C=!1,maxWidth:I="sm",onClick:$,onClose:D,open:n,PaperComponent:u=N,PaperProps:O={},scroll:Q="paper",slots:Z={},slotProps:oo={},TransitionComponent:eo=H,transitionDuration:q=a,TransitionProps:to,...so}=r,w={...r,disableEscapeKeyDown:f,fullScreen:y,fullWidth:C,maxWidth:I,scroll:Q},F=Fo(w),L=p.useRef(),ro=j=>{L.current=j.target===j.currentTarget},no=j=>{$&&$(j),L.current&&(L.current=null,D&&D(j,"backdropClick"))},B=ko(c),ao=p.useMemo(()=>({titleId:B}),[B]),io={transition:eo,...Z},lo={transition:to,paper:O,backdrop:x,...oo},P={slots:io,slotProps:lo},[co,po]=k("root",{elementType:Lo,shouldForwardComponentProp:!0,externalForwardedProps:P,ownerState:w,className:b(F.root,m),ref:s}),[uo,mo]=k("backdrop",{elementType:Io,shouldForwardComponentProp:!0,externalForwardedProps:P,ownerState:w}),[go,ho]=k("paper",{elementType:Uo,shouldForwardComponentProp:!0,externalForwardedProps:P,ownerState:w,className:b(F.paper,O.className)}),[xo,fo]=k("container",{elementType:Bo,externalForwardedProps:P,ownerState:w,className:b(F.container)}),[vo,bo]=k("transition",{elementType:H,externalForwardedProps:P,ownerState:w,additionalProps:{appear:!0,in:n,timeout:q,role:"presentation"}});return t.jsx(co,{closeAfterTransition:!0,slots:{backdrop:uo},slotProps:{backdrop:{transitionDuration:q,as:h,...mo}},disableEscapeKeyDown:f,onClose:D,open:n,onClick:no,...po,...so,children:t.jsx(vo,{...bo,children:t.jsx(xo,{onMouseDown:ro,...fo,children:t.jsx(go,{as:u,elevation:24,role:"dialog","aria-describedby":i,"aria-labelledby":B,"aria-modal":d,...ho,children:t.jsx(J.Provider,{value:ao,children:S})})})})})});function No(e){return T("MuiDialogActions",e)}A("MuiDialogActions",["root","spacing"]);const zo=e=>{const{classes:o,disableSpacing:s}=e;return W({root:["root",!s&&"spacing"]},No,o)},Oo=v("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.root,!s.disableSpacing&&o.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:e})=>!e.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),qo=p.forwardRef(function(o,s){const r=R({props:o,name:"MuiDialogActions"}),{className:l,disableSpacing:a=!1,...i}=r,c={...r,disableSpacing:a},d=zo(c);return t.jsx(Oo,{className:b(d.root,l),ownerState:c,ref:s,...i})});function Yo(e){return T("MuiDialogContent",e)}A("MuiDialogContent",["root","dividers"]);function _o(e){return T("MuiDialogTitle",e)}const Ho=A("MuiDialogTitle",["root"]),Vo=e=>{const{classes:o,dividers:s}=e;return W({root:["root",s&&"dividers"]},Yo,o)},Xo=v("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.root,s.dividers&&o.dividers]}})(z(({theme:e})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:o})=>o.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:o})=>!o.dividers,style:{[`.${Ho.root} + &`]:{paddingTop:0}}}]}))),Ko=p.forwardRef(function(o,s){const r=R({props:o,name:"MuiDialogContent"}),{className:l,dividers:a=!1,...i}=r,c={...r,dividers:a},d=Vo(c);return t.jsx(Xo,{className:b(d.root,l),ownerState:c,ref:s,...i})}),Go=e=>{const{classes:o}=e;return W({root:["root"]},_o,o)},Jo=v(M,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,o)=>o.root})({padding:"16px 24px",flex:"0 0 auto"}),Qo=p.forwardRef(function(o,s){const r=R({props:o,name:"MuiDialogTitle"}),{className:l,id:a,...i}=r,c=r,d=Go(c),{titleId:h=a}=p.useContext(J);return t.jsx(Jo,{component:"h2",className:b(d.root,l),ownerState:c,ref:s,variant:"h6",id:a??h,...i})});function Zo(e){return T("MuiInputAdornment",e)}const X=A("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var K;const oe=(e,o)=>{const{ownerState:s}=e;return[o.root,o[`position${g(s.position)}`],s.disablePointerEvents===!0&&o.disablePointerEvents,o[s.variant]]},ee=e=>{const{classes:o,disablePointerEvents:s,hiddenLabel:r,position:l,size:a,variant:i}=e,c={root:["root",s&&"disablePointerEvents",l&&`position${g(l)}`,i,r&&"hiddenLabel",a&&`size${g(a)}`]};return W(c,Zo,o)},te=v("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:oe})(z(({theme:e})=>({display:"flex",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(e.vars||e).palette.action.active,variants:[{props:{variant:"filled"},style:{[`&.${X.positionStart}&:not(.${X.hiddenLabel})`]:{marginTop:16}}},{props:{position:"start"},style:{marginRight:8}},{props:{position:"end"},style:{marginLeft:8}},{props:{disablePointerEvents:!0},style:{pointerEvents:"none"}}]}))),se=p.forwardRef(function(o,s){const r=R({props:o,name:"MuiInputAdornment"}),{children:l,className:a,component:i="div",disablePointerEvents:c=!1,disableTypography:d=!1,position:h,variant:x,...S}=r,m=To()||{};let f=x;x&&m.variant,m&&!f&&(f=m.variant);const y={...r,hiddenLabel:m.hiddenLabel,size:m.size,disablePointerEvents:c,position:h,variant:f},C=ee(y);return t.jsx(Ro.Provider,{value:null,children:t.jsx(te,{as:i,ownerState:y,className:b(C.root,a),ref:s,...S,children:typeof l=="string"&&!d?t.jsx(M,{color:"textSecondary",children:l}):t.jsxs(p.Fragment,{children:[h==="start"?K||(K=t.jsx("span",{className:"notranslate","aria-hidden":!0,children:"â€‹"})):null,l]})})})}),re=G(t.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"})),ne=G(t.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"})),ae=()=>{const[e,o]=p.useState(!1),[s,r]=p.useState(null),[l,a]=p.useState(!1),[i,c]=p.useState({username:"",password:""}),d=Co(),h=wo(),[x,S]=So.useState(!1),m=()=>S(n=>!n),f=n=>{n.preventDefault()},y=n=>{n.preventDefault()};p.useEffect(()=>{I()},[]);const C=n=>{if(n){const u=d.state;u.substring(1,u.length-1),console.log(d.state),h(u)}},I=async()=>{console.log("check login");try{const n=await Y.get("/api/check-session",{withCredentials:!0});console.log(n.data,"here"),n.data.loggedIn&&(C(n.data.loggedIn),a(!0))}catch{a(!0)}},$=async n=>{n.preventDefault(),o(!0);try{const u=await Y.post("/api/proxy",{request:{Auth:{Phone:"7012326844",Username:i.username,Password:i.password},Request:{DataFormat:"json",Module:"membership",Section:"directory",Action:"read"}}},{withCredentials:!0});if(u.data.session&&C(u.data.session),u.data.number){D(u.data);return}}catch(u){r("Login failed"),console.error(u)}finally{o(!1)}},D=n=>{r(`Error ${n.number}: ${n.message||"Unknown error"}`)};return t.jsx(Po,{maxWidth:"lg",sx:{mt:4,mb:4},children:t.jsxs(N,{elevation:3,sx:{p:4},children:[t.jsxs(_,{display:"flex",alignItems:"center",mb:4,children:[t.jsx(Do,{src:"/CP/order-online/images/dove_logo_cmo_wordless.png",alt:"Icon Systems logo",sx:{width:60,height:60,mr:2}}),t.jsx(M,{variant:"h3",component:"h1",children:t.jsx("b",{children:t.jsx("i",{children:"IconCMO API â€” Directory"})})})]}),t.jsx("hr",{}),s&&t.jsx(M,{color:"error",sx:{mb:2},children:s}),t.jsxs(_,{textAlign:"center",my:4,children:[t.jsx(M,{variant:"h6",gutterBottom:!0,children:"Please log in to view the directory"}),t.jsx(U,{variant:"contained",onClick:()=>a(!0),children:"Login"})]}),t.jsxs(Eo,{open:l,onClose:()=>a(!1),children:[t.jsx(Qo,{children:"Please log in"}),t.jsxs("form",{onSubmit:$,children:[t.jsxs(Ko,{children:[t.jsx(V,{autoFocus:!0,margin:"dense",label:"Username",type:"text",fullWidth:!0,variant:"standard",value:i.username,onChange:n=>c({...i,username:n.target.value}),required:!0}),t.jsx(V,{margin:"dense",label:"Password",fullWidth:!0,variant:"standard",value:i.password,onChange:n=>c({...i,password:n.target.value}),type:x?"text":"password",InputProps:{endAdornment:t.jsx(se,{position:"end",children:t.jsx(Wo,{"aria-label":x?"hide the password":"display the password",onClick:m,onMouseDown:f,onMouseUp:y,edge:"end",children:x?t.jsx(ne,{}):t.jsx(re,{})})})},required:!0})]}),t.jsxs(qo,{children:[t.jsx(U,{onClick:()=>a(!1),children:"Cancel"}),t.jsx(U,{type:"submit",disabled:e,children:e?"Logging in...":"Login"})]})]})]})]})})},De=yo(ae);export{De as default};
