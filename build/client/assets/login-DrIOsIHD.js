import{w as yo}from"./with-props-BhD4tHF7.js";import{r as p,l as e,t as Co,n as wo,q as So}from"./chunk-XJI4KG32-Cq5X3dzK.js";import{a as Y,A as Do}from"./directory-BfESHIgg.js";import{u as k,c as G}from"./useSlot-D_iM7ehJ.js";import{C as Po}from"./Container-CLeR-vTm.js";import{c as jo,P as N}from"./isFocusVisible-CqNmDtJi.js";import{a as A,g as T,c as w,e as g,B as _}from"./Box-BzE_XOeT.js";import{T as M}from"./Typography-0Hd1KltR.js";import{u as ko,B as U}from"./Button-Cnz__5mg.js";import{u as W,s as v,c as R,m as z}from"./createSimplePaletteValueFilter-DGnNz9q7.js";import{F as H,M as Mo,B as Ao,u as To,a as Wo,T as V}from"./TextField-BWrHybeP.js";import{I as Ro}from"./IconButton-BoMGrkvG.js";import"./useThemeProps-CY1YPL9X.js";import"./assertThisInitialized-BjnbojEp.js";import"./isHostComponent-0qkTbIj_.js";import"./utils-DP801Ijz.js";import"./index-CVTmJPMc.js";import"./isMuiElement-D8UOlcw4.js";function $o(o){return T("MuiDialog",o)}const E=A("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),J=p.createContext({}),Io=v(Ao,{name:"MuiDialog",slot:"Backdrop",overrides:(o,t)=>t.backdrop})({zIndex:-1}),Fo=o=>{const{classes:t,scroll:s,maxWidth:n,fullWidth:l,fullScreen:a}=o,i={root:["root"],container:["container",`scroll${g(s)}`],paper:["paper",`paperScroll${g(s)}`,`paperWidth${g(String(n))}`,l&&"paperFullWidth",a&&"paperFullScreen"]};return R(i,$o,t)},Lo=v(Mo,{name:"MuiDialog",slot:"Root"})({"@media print":{position:"absolute !important"}}),Bo=v("div",{name:"MuiDialog",slot:"Container",overridesResolver:(o,t)=>{const{ownerState:s}=o;return[t.container,t[`scroll${g(s.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),Uo=v(N,{name:"MuiDialog",slot:"Paper",overridesResolver:(o,t)=>{const{ownerState:s}=o;return[t.paper,t[`scrollPaper${g(s.scroll)}`],t[`paperWidth${g(String(s.maxWidth))}`],s.fullWidth&&t.paperFullWidth,s.fullScreen&&t.paperFullScreen]}})(z(({theme:o})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:t})=>!t.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:o.breakpoints.unit==="px"?Math.max(o.breakpoints.values.xs,444):`max(${o.breakpoints.values.xs}${o.breakpoints.unit}, 444px)`,[`&.${E.paperScrollBody}`]:{[o.breakpoints.down(Math.max(o.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(o.breakpoints.values).filter(t=>t!=="xs").map(t=>({props:{maxWidth:t},style:{maxWidth:`${o.breakpoints.values[t]}${o.breakpoints.unit}`,[`&.${E.paperScrollBody}`]:{[o.breakpoints.down(o.breakpoints.values[t]+32*2)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:t})=>t.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:t})=>t.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${E.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),Eo=p.forwardRef(function(t,s){const n=W({props:t,name:"MuiDialog"}),l=jo(),a={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{"aria-describedby":i,"aria-labelledby":c,"aria-modal":d=!0,BackdropComponent:h,BackdropProps:x,children:S,className:m,disableEscapeKeyDown:f=!1,fullScreen:b=!1,fullWidth:y=!1,maxWidth:I="sm",onClick:$,onClose:D,open:r,PaperComponent:u=N,PaperProps:O={},scroll:Q="paper",slots:Z={},slotProps:oo={},TransitionComponent:to=H,transitionDuration:q=a,TransitionProps:eo,...so}=n,C={...n,disableEscapeKeyDown:f,fullScreen:b,fullWidth:y,maxWidth:I,scroll:Q},F=Fo(C),L=p.useRef(),no=j=>{L.current=j.target===j.currentTarget},ro=j=>{$&&$(j),L.current&&(L.current=null,D&&D(j,"backdropClick"))},B=ko(c),ao=p.useMemo(()=>({titleId:B}),[B]),io={transition:to,...Z},lo={transition:eo,paper:O,backdrop:x,...oo},P={slots:io,slotProps:lo},[co,po]=k("root",{elementType:Lo,shouldForwardComponentProp:!0,externalForwardedProps:P,ownerState:C,className:w(F.root,m),ref:s}),[uo,mo]=k("backdrop",{elementType:Io,shouldForwardComponentProp:!0,externalForwardedProps:P,ownerState:C}),[go,ho]=k("paper",{elementType:Uo,shouldForwardComponentProp:!0,externalForwardedProps:P,ownerState:C,className:w(F.paper,O.className)}),[xo,fo]=k("container",{elementType:Bo,externalForwardedProps:P,ownerState:C,className:F.container}),[vo,bo]=k("transition",{elementType:H,externalForwardedProps:P,ownerState:C,additionalProps:{appear:!0,in:r,timeout:q,role:"presentation"}});return e.jsx(co,{closeAfterTransition:!0,slots:{backdrop:uo},slotProps:{backdrop:{transitionDuration:q,as:h,...mo}},disableEscapeKeyDown:f,onClose:D,open:r,onClick:ro,...po,...so,children:e.jsx(vo,{...bo,children:e.jsx(xo,{onMouseDown:no,...fo,children:e.jsx(go,{as:u,elevation:24,role:"dialog","aria-describedby":i,"aria-labelledby":B,"aria-modal":d,...ho,children:e.jsx(J.Provider,{value:ao,children:S})})})})})});function No(o){return T("MuiDialogActions",o)}A("MuiDialogActions",["root","spacing"]);const zo=o=>{const{classes:t,disableSpacing:s}=o;return R({root:["root",!s&&"spacing"]},No,t)},Oo=v("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(o,t)=>{const{ownerState:s}=o;return[t.root,!s.disableSpacing&&t.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:o})=>!o.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),qo=p.forwardRef(function(t,s){const n=W({props:t,name:"MuiDialogActions"}),{className:l,disableSpacing:a=!1,...i}=n,c={...n,disableSpacing:a},d=zo(c);return e.jsx(Oo,{className:w(d.root,l),ownerState:c,ref:s,...i})});function Yo(o){return T("MuiDialogContent",o)}A("MuiDialogContent",["root","dividers"]);function _o(o){return T("MuiDialogTitle",o)}const Ho=A("MuiDialogTitle",["root"]),Vo=o=>{const{classes:t,dividers:s}=o;return R({root:["root",s&&"dividers"]},Yo,t)},Xo=v("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(o,t)=>{const{ownerState:s}=o;return[t.root,s.dividers&&t.dividers]}})(z(({theme:o})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:t})=>t.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(o.vars||o).palette.divider}`,borderBottom:`1px solid ${(o.vars||o).palette.divider}`}},{props:({ownerState:t})=>!t.dividers,style:{[`.${Ho.root} + &`]:{paddingTop:0}}}]}))),Ko=p.forwardRef(function(t,s){const n=W({props:t,name:"MuiDialogContent"}),{className:l,dividers:a=!1,...i}=n,c={...n,dividers:a},d=Vo(c);return e.jsx(Xo,{className:w(d.root,l),ownerState:c,ref:s,...i})}),Go=o=>{const{classes:t}=o;return R({root:["root"]},_o,t)},Jo=v(M,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),Qo=p.forwardRef(function(t,s){const n=W({props:t,name:"MuiDialogTitle"}),{className:l,id:a,...i}=n,c=n,d=Go(c),{titleId:h=a}=p.useContext(J);return e.jsx(Jo,{component:"h2",className:w(d.root,l),ownerState:c,ref:s,variant:"h6",id:a??h,...i})});function Zo(o){return T("MuiInputAdornment",o)}const X=A("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var K;const ot=(o,t)=>{const{ownerState:s}=o;return[t.root,t[`position${g(s.position)}`],s.disablePointerEvents===!0&&t.disablePointerEvents,t[s.variant]]},tt=o=>{const{classes:t,disablePointerEvents:s,hiddenLabel:n,position:l,size:a,variant:i}=o,c={root:["root",s&&"disablePointerEvents",l&&`position${g(l)}`,i,n&&"hiddenLabel",a&&`size${g(a)}`]};return R(c,Zo,t)},et=v("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:ot})(z(({theme:o})=>({display:"flex",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(o.vars||o).palette.action.active,variants:[{props:{variant:"filled"},style:{[`&.${X.positionStart}&:not(.${X.hiddenLabel})`]:{marginTop:16}}},{props:{position:"start"},style:{marginRight:8}},{props:{position:"end"},style:{marginLeft:8}},{props:{disablePointerEvents:!0},style:{pointerEvents:"none"}}]}))),st=p.forwardRef(function(t,s){const n=W({props:t,name:"MuiInputAdornment"}),{children:l,className:a,component:i="div",disablePointerEvents:c=!1,disableTypography:d=!1,position:h,variant:x,...S}=n,m=To()||{};let f=x;x&&m.variant,m&&!f&&(f=m.variant);const b={...n,hiddenLabel:m.hiddenLabel,size:m.size,disablePointerEvents:c,position:h,variant:f},y=tt(b);return e.jsx(Wo.Provider,{value:null,children:e.jsx(et,{as:i,ownerState:b,className:w(y.root,a),ref:s,...S,children:typeof l=="string"&&!d?e.jsx(M,{color:"textSecondary",children:l}):e.jsxs(p.Fragment,{children:[h==="start"?K||(K=e.jsx("span",{className:"notranslate","aria-hidden":!0,children:"â€‹"})):null,l]})})})}),nt=G(e.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"})),rt=G(e.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}));function Pt({}){return[{title:"login"},{name:"description",content:"login"}]}const at=()=>{const[o,t]=p.useState(!1),[s,n]=p.useState(null),[l,a]=p.useState(!1),[i,c]=p.useState({username:"",password:""}),d=Co(),h=wo(),[x,S]=So.useState(!1),m=()=>S(r=>!r),f=r=>{r.preventDefault()},b=r=>{r.preventDefault()};p.useEffect(()=>{I()},[]);const y=r=>{if(r){const u=d.state;u.substring(1,u.length-1),console.log(d.state),h(u)}},I=async()=>{console.log("check login");try{const r=await Y.get("/api/check-session",{withCredentials:!0});console.log(r.data,"here"),r.data.loggedIn&&(y(r.data.loggedIn),a(!0))}catch{a(!0)}},$=async r=>{r.preventDefault(),t(!0);try{const u=await Y.post("/api/proxy",{request:{Auth:{Phone:"7012326844",Username:i.username,Password:i.password},Request:{DataFormat:"json",Module:"membership",Section:"directory",Action:"read"}}},{withCredentials:!0});if(u.data.session&&y(u.data.session),u.data.number){D(u.data);return}}catch(u){n("Login failed"),console.error(u)}finally{t(!1)}},D=r=>{n(`Error ${r.number}: ${r.message||"Unknown error"}`)};return e.jsx(Po,{maxWidth:"lg",sx:{mt:4,mb:4},children:e.jsxs(N,{elevation:3,sx:{p:4},children:[e.jsxs(_,{display:"flex",alignItems:"center",mb:4,children:[e.jsx(Do,{src:"/CP/order-online/images/dove_logo_cmo_wordless.png",alt:"Icon Systems logo",sx:{width:60,height:60,mr:2}}),e.jsx(M,{variant:"h3",component:"h1",children:e.jsx("b",{children:e.jsx("i",{children:"IconCMO API â€” Directory"})})})]}),e.jsx("hr",{}),s&&e.jsx(M,{color:"error",sx:{mb:2},children:s}),e.jsxs(_,{textAlign:"center",my:4,children:[e.jsx(M,{variant:"h6",gutterBottom:!0,children:"Please log in to view the directory"}),e.jsx(U,{variant:"contained",onClick:()=>a(!0),children:"Login"})]}),e.jsxs(Eo,{open:l,onClose:()=>a(!1),children:[e.jsx(Qo,{children:"Please log in"}),e.jsxs("form",{onSubmit:$,children:[e.jsxs(Ko,{children:[e.jsx(V,{autoFocus:!0,margin:"dense",label:"Username",type:"text",fullWidth:!0,variant:"standard",value:i.username,onChange:r=>c({...i,username:r.target.value}),required:!0}),e.jsx(V,{margin:"dense",label:"Password",fullWidth:!0,variant:"standard",value:i.password,onChange:r=>c({...i,password:r.target.value}),type:x?"text":"password",InputProps:{endAdornment:e.jsx(st,{position:"end",children:e.jsx(Ro,{"aria-label":x?"hide the password":"display the password",onClick:m,onMouseDown:f,onMouseUp:b,edge:"end",children:x?e.jsx(rt,{}):e.jsx(nt,{})})})},required:!0})]}),e.jsxs(qo,{children:[e.jsx(U,{onClick:()=>a(!1),children:"Cancel"}),e.jsx(U,{type:"submit",disabled:o,children:o?"Logging in...":"Login"})]})]})]})]})})},jt=yo(at);export{jt as default,Pt as meta};
