import{w as A}from"./with-props-XfvYlEA1.js";import{r,l as e,t as L,n as T,q as k}from"./chunk-XJI4KG32-BAmN-UB5.js";import{a as w,A as U}from"./directory-DEPkQ442.js";import{c as C}from"./createSvgIcon-C_B90T8I.js";import{C as B}from"./Container-CWxUdSJQ.js";import{P as E}from"./isFocusVisible-Cag1cr_-.js";import{u as R,s as q,c as F,b as O,B as j}from"./Box-zKM1Z_PT.js";import{T as p}from"./Typography-C69A11IE.js";import{B as x}from"./Button-Cyu2DNrz.js";import{D as N,g as W,a as _,b as z,I as V,c as $}from"./InputAdornment-DLZVWhgV.js";import{T as y}from"./TextField-CakiGRDE.js";import{I as G}from"./IconButton-DUG1jLxH.js";import"./useSlot-CeTJAII2.js";import"./styled-B8HCHhmZ.js";import"./useThemeProps--VOYLnFT.js";import"./isHostComponent-DhGQrk_S.js";import"./utils-BBwFLXQx.js";import"./index-BDZ0irRG.js";import"./isMuiElement-DrURY2j0.js";const H=i=>{const{classes:a}=i;return O({root:["root"]},W,a)},J=q(p,{name:"MuiDialogTitle",slot:"Root"})({padding:"16px 24px",flex:"0 0 auto"}),K=r.forwardRef(function(a,l){const c=R({props:a,name:"MuiDialogTitle"}),{className:u,id:o,...n}=c,d=c,m=H(d),{titleId:g=o}=r.useContext(N);return e.jsx(J,{component:"h2",className:F(m.root,u),ownerState:d,ref:l,variant:"h6",id:o??g,...n})}),Q=C(e.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"})),X=C(e.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}));function we({}){return[{title:"login"},{name:"description",content:"login"}]}const Y=()=>{const[i,a]=r.useState(!1),[l,c]=r.useState(null),[u,o]=r.useState(!1),[n,d]=r.useState({username:"",password:""}),m=L(),g=T(),[h,v]=k.useState(!1),D=()=>v(s=>!s),P=s=>{s.preventDefault()},b=s=>{s.preventDefault()};r.useEffect(()=>{I()},[]);const f=s=>{if(s){const t=m.state;t.substring(1,t.length-1),console.log(m.state),g(t)}},I=async()=>{console.log("check login");try{const s=await w.get("/api/check-session",{withCredentials:!0});console.log(s.data,"here"),s.data.loggedIn&&(f(s.data.loggedIn),o(!0))}catch{o(!0)}},M=async s=>{s.preventDefault(),a(!0);try{const t=await w.post("/api/proxy",{request:{Auth:{Phone:"7012326844",Username:n.username,Password:n.password},Request:{DataFormat:"json",Module:"membership",Section:"directory",Action:"read"}}},{withCredentials:!0});if(t.data.session&&f(t.data.session),t.data.number){S(t.data);return}}catch(t){c("Login failed"),console.error(t)}finally{a(!1)}},S=s=>{c(`Error ${s.number}: ${s.message||"Unknown error"}`)};return e.jsx(B,{maxWidth:"lg",sx:{mt:4,mb:4},children:e.jsxs(E,{elevation:3,sx:{p:4},children:[e.jsxs(j,{display:"flex",alignItems:"center",mb:4,children:[e.jsx(U,{src:"/CP/order-online/images/dove_logo_cmo_wordless.png",alt:"Icon Systems logo",sx:{width:60,height:60,mr:2}}),e.jsx(p,{variant:"h3",component:"h1",children:e.jsx("b",{children:e.jsx("i",{children:"IconCMO API â€” Directory"})})})]}),e.jsx("hr",{}),l&&e.jsx(p,{color:"error",sx:{mb:2},children:l}),e.jsxs(j,{textAlign:"center",my:4,children:[e.jsx(p,{variant:"h6",gutterBottom:!0,children:"Please log in to view the directory"}),e.jsx(x,{variant:"contained",onClick:()=>o(!0),children:"Login"})]}),e.jsxs(_,{open:u,onClose:()=>o(!1),children:[e.jsx(K,{children:"Please log in"}),e.jsxs("form",{onSubmit:M,children:[e.jsxs(z,{children:[e.jsx(y,{autoFocus:!0,margin:"dense",label:"Username",type:"text",fullWidth:!0,variant:"standard",value:n.username,onChange:s=>d({...n,username:s.target.value}),required:!0}),e.jsx(y,{margin:"dense",label:"Password",fullWidth:!0,variant:"standard",value:n.password,onChange:s=>d({...n,password:s.target.value}),type:h?"text":"password",InputProps:{endAdornment:e.jsx(V,{position:"end",children:e.jsx(G,{"aria-label":h?"hide the password":"display the password",onClick:D,onMouseDown:P,onMouseUp:b,edge:"end",children:h?e.jsx(X,{}):e.jsx(Q,{})})})},required:!0})]}),e.jsxs($,{children:[e.jsx(x,{onClick:()=>o(!1),children:"Cancel"}),e.jsx(x,{type:"submit",disabled:i,children:i?"Logging in...":"Login"})]})]})]})]})})},je=A(Y);export{je as default,we as meta};
